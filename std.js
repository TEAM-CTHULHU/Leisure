var std = (function(){
var root;

if ((typeof window !== 'undefined' && window !== null) && (!(typeof global !== 'undefined' && global !== null) || global === window)) {
  std = root = {};
  global = window;
  module = {};
} else {
  root = typeof exports !== 'undefined' && exports !== null ? exports : this;
  Parse = require('./parse');
  Leisure = require('./leisure');
  Prim = require('./prim');
  //
  
  ReplCore = require('./replCore');
  Repl = require('./repl');
}

Prim.loading('std.lsr')


var Nil = Parse.Nil;
var cons = Parse.cons;
var primCons = Parse.primCons;
var setType = Parse.setType;
var setDataType = Parse.setDataType;
var define = Parse.define;
var processResult = Repl.processResult;
var setContext = Leisure.setContext;
var funcContext = Leisure.funcContext;
var define = Parse.define;
var wrapContext = Leisure.wrapContext;
var markLeisureErrors = Leisure.markLeisureErrors;

module.exports =   (_defGroup()((function(){return "["}))((function(){return "]"})))
.andThen(function(){ return   (_defGroup()((function(){return "concat["}))((function(){return "]"})))})
.andThen(function(){ return   (_defToken()((function(){return "|"})))})
.andThen(function(){ return   (_defToken()((function(){return ","})))})
.andThen(function(){ return   (_defToken()((function(){return "<-"})))})
.andThen(function(){ return   (_defToken()((function(){return "::"})))})
.andThen(function(){
  _id = Parse.define('id', (function() {var f; return function _id(){return f || (f = (function(_x){return _x();}));}})(), 1, "\\x . x");;
  _flip = Parse.define('flip', (function() {var f; return function _flip(){return f || (f = (Parse.setDataType(function(_f){return Parse.setType(function(_a){return function(_b){return _f()(_b)(_a);};}, 'flip');}, 'flip')));}})(), 1, "\\f . \\a b . f b a");;
  _compose = Parse.define('compose', (function() {var f; return function _compose(){return f || (f = (Parse.setDataType(function(_f){return function(_g){return Parse.setType(function(_x){return _f()((function(){var $m; return (function(){return $m || ($m = (_g()(_x)))})})());}, 'compose');};}, 'compose')));}})(), 2, "\\f g . \\x . f ( g x)");;
  _true = Parse.define('true', (function() {var f; return function _true(){return f || (f = (Parse.setType(function(_a){return function(_b){return _a();};}, 'true')));}})(), 0, "\\a b . a");;
  _false = Parse.define('false', (function() {var f; return function _false(){return f || (f = (Parse.setType(function(_a){return function(_b){return _b();};}, 'false')));}})(), 0, "\\a b . b");;
  _and = Parse.define('and', (function() {var f; return function _and(){return f || (f = (function(_a){return function(_b){return _a()(_b)(_false);};}));}})(), 2, "\\a b . a b false");;
  _or = Parse.define('or', (function() {var f; return function _or(){return f || (f = (function(_a){return _a()(_true);}));}})(), 1, "\\a . a true");;
  _not = Parse.define('not', (function() {var f; return function _not(){return f || (f = (function(_a){return _a()(_false)(_true);}));}})(), 1, "\\a . a false true");;
  _neq = Parse.define('neq', (function() {var f; return function _neq(){return f || (f = (function(_a){return function(_b){return _not()((function(){var $m; return (function(){return $m || ($m = (_eq()(_a)(_b)))})})());};}));}})(), 2, "\\a b . not (eq a b)");;
  _left = Parse.define('left', (function() {var f; return function _left(){return f || (f = (Parse.setDataType(function(_v){return Parse.setType(function(_l){return function(_r){return _l()(_v);};}, 'left');}, 'left')));}})(), 1, "\\v . \\l r . l v");;
  _right = Parse.define('right', (function() {var f; return function _right(){return f || (f = (Parse.setDataType(function(_v){return Parse.setType(function(_l){return function(_r){return _r()(_v);};}, 'right');}, 'right')));}})(), 1, "\\v . \\l r . r v");;
  _some = Parse.define('some', (function() {var f; return function _some(){return f || (f = (Parse.setDataType(function(_x){return Parse.setType(function(_yes){return function(_no){return _yes()(_x);};}, 'some');}, 'some')));}})(), 1, "\\x . \\yes no . yes x");;
  _some2 = Parse.define('some2', (function() {var f; return function _some2(){return f || (f = (Parse.setDataType(function(_a){return function(_b){return Parse.setType(function(_yes){return function(_no){return _yes()(_a)(_b);};}, 'some2');};}, 'some2')));}})(), 2, "\\a b . \\yes no . yes a b");;
  _none = Parse.define('none', (function() {var f; return function _none(){return f || (f = (Parse.setType(function(_yes){return function(_no){return _no();};}, 'none')));}})(), 0, "\\yes no . no");;
  _iszero = Parse.define('iszero', (function _iszero() {return ((_eq()((function(){return 0}))));}), 0, "eq 0");;
  _positive = Parse.define('positive', (function _positive() {return ((_$y()((function(){return 0}))));}), 0, "< 0");;
  _$_$_ = Parse.define('--', (function _$_$_() {return ((_flip()(_$_)((function(){return 1}))));}), 0, "(flip -) 1");;
  _$o$o = Parse.define('++', (function _$o$o() {return ((_$o()((function(){return 1}))));}), 0, "+ 1");;
  _even$e = Parse.define('even?', (function() {var f; return function _even$e(){return f || (f = (function(_x){return _iszero()((function(){var $m; return (function(){return $m || ($m = (_$A()(_x)((function(){return 2}))))})})());}));}})(), 1, "\\x . iszero (% x 2)");;
  _odd$e = Parse.define('odd?', (function() {var f; return function _odd$e(){return f || (f = (function(_x){return _eq()((function(){return 1}))((function(){var $m; return (function(){return $m || ($m = (_$A()(_x)((function(){return 2}))))})})());}));}})(), 1, "\\x . eq 1 (% x 2)");;
  _max = Parse.define('max', (function() {var f; return function _max(){return f || (f = (function(_a){return function(_b){return _gt()(_a)(_b)(_a)(_b);};}));}})(), 2, "\\a b . (gt a b) a b");;
  _min = Parse.define('min', (function() {var f; return function _min(){return f || (f = (function(_a){return function(_b){return _lt()(_a)(_b)(_a)(_b);};}));}})(), 2, "\\a b . (lt a b) a b");;
  _isStream = Parse.define('isStream', (function() {var f; return function _isStream(){return f || (f = (function(_x){return _false();}));}})(), 1, "\\x . false");;
  _isStream = Leisure.makeDispatchFunction('isStream', '_isStream', '_x', ['_isStream', '_x']);
Leisure.createMethod('cons', 'isStream', "\\x       . true", function(_x) {return _true();});
  _isStream = Leisure.makeDispatchFunction('isStream', '_isStream', '_x', ['_isStream', '_x']);
Leisure.createMethod('lexCons', 'isStream', "\\x          . true", function(_x) {return _true();});
  _head = Leisure.makeDispatchFunction('head', '_head', '_l', ['_head', '_l']);
Leisure.createMethod('cons', 'head', "\\l       . l \\h t . h", function(_l) {return _l()((function(){var $m; return (function(){return $m || ($m = (function(_h){return function(_t){return _h();};}))})})());});
  _tail = Leisure.makeDispatchFunction('tail', '_tail', '_l', ['_tail', '_l']);
Leisure.createMethod('cons', 'tail', "\\l       . l \\h t . t", function(_l) {return _l()((function(){var $m; return (function(){return $m || ($m = (function(_h){return function(_t){return _t();};}))})})());});
  _head = Leisure.makeDispatchFunction('head', '_head', '_l', ['_head', '_l']);
Leisure.createMethod('lexCons', 'head', "\\l          . l \\h s t e . h", function(_l) {return _l()((function(){var $m; return (function(){return $m || ($m = (function(_h){return function(_s){return function(_t){return function(_e){return _h();};};};}))})})());});
  _tail = Leisure.makeDispatchFunction('tail', '_tail', '_l', ['_tail', '_l']);
Leisure.createMethod('lexCons', 'tail', "\\l          . l \\h s t e . t", function(_l) {return _l()((function(){var $m; return (function(){return $m || ($m = (function(_h){return function(_s){return function(_t){return function(_e){return _t();};};};}))})})());});
  _length = Parse.define('length', (function() {var f; return function _length(){return f || (f = (function(_l){return _eq()(_l)(_nil)((function(){return 0}))((function(){var $m; return (function(){return $m || ($m = (_$o$o()((function(){var $m; return (function(){return $m || ($m = (_length()((function(){var $m; return (function(){return $m || ($m = (_tail()(_l)))})})())))})})())))})})());}));}})(), 1, "\\l . (eq l nil) 0 (++ (length (tail l) ) )");;
  _last = Parse.define('last', (function() {var f; return function _last(){return f || (f = (function(_l){return _eq()((function(){var $m; return (function(){return $m || ($m = (_tail()(_l)))})})())(_nil)((function(){var $m; return (function(){return $m || ($m = (_head()(_l)))})})())((function(){var $m; return (function(){return $m || ($m = (_last()((function(){var $m; return (function(){return $m || ($m = (_tail()(_l)))})})())))})})());}));}})(), 1, "\\l . eq (tail l) nil\n  head l\n  last (tail l)");;
  _startPos = Leisure.makeDispatchFunction('startPos', '_startPos', '_l', ['_startPos', '_l']);
Leisure.createMethod('lexCons', 'startPos', "\\l          . lexStart l", function(_l) {return _lexStart()(_l);});
  _startPos = Leisure.makeDispatchFunction('startPos', '_startPos', '_t', ['_startPos', '_t']);
Leisure.createMethod('token', 'startPos', "\\t        . t \\t p . p", function(_t) {return _t()((function(){var $m; return (function(){return $m || ($m = (function(_t){return function(_p){return _p();};}))})})());});
  _endPos = Leisure.makeDispatchFunction('endPos', '_endPos', '_l', ['_endPos', '_l']);
Leisure.createMethod('lexCons', 'endPos', "\\l          . lexEnd l", function(_l) {return _lexEnd()(_l);});
  _endPos = Leisure.makeDispatchFunction('endPos', '_endPos', '_t', ['_endPos', '_t']);
Leisure.createMethod('token', 'endPos', "\\t        . + (tokenStart t) (strlen (tokenName t))", function(_t) {return _$o()((function(){var $m; return (function(){return $m || ($m = (_tokenStart()(_t)))})})())((function(){var $m; return (function(){return $m || ($m = (_strlen()((function(){var $m; return (function(){return $m || ($m = (_tokenName()(_t)))})})())))})})());});
  _pairFunc = Parse.define('pairFunc', (function() {var f; return function _pairFunc(){return f || (f = (function(_l){return _false();}));}})(), 1, "\\l . false");;
  _pairFunc = Leisure.makeDispatchFunction('pairFunc', '_pairFunc', '_l', ['_pairFunc', '_l']);
Leisure.createMethod('cons', 'pairFunc', "\\l       . cons", function(_l) {return _cons();});
  _pairFunc = Leisure.makeDispatchFunction('pairFunc', '_pairFunc', '_l', ['_pairFunc', '_l']);
Leisure.createMethod('lexCons', 'pairFunc', "\\l          . lexConsFuzzy", function(_l) {return _lexConsFuzzy();});
  _pairFunc = Leisure.makeDispatchFunction('pairFunc', '_pairFunc', '_l', ['_pairFunc', '_l']);
Leisure.createMethod('token', 'pairFunc', "\\l        . lexConsFuzzy", function(_l) {return _lexConsFuzzy();});
  _lexConsFuzzy = Parse.define('lexConsFuzzy', (function() {var f; return function _lexConsFuzzy(){return f || (f = (function(_h){return function(_t){return _null$e()(_t)((function(){var $m; return (function(){return $m || ($m = (_lexCons()(_h)((function(){var $m; return (function(){return $m || ($m = (_startPos()(_h)))})})())(_nil)((function(){var $m; return (function(){return $m || ($m = (_endPos()(_h)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_lexCons()(_h)((function(){var $m; return (function(){return $m || ($m = (_startPos()(_h)))})})())(_t)((function(){var $m; return (function(){return $m || ($m = (_endPos()(_t)))})})())))})})());};}));}})(), 2, "\\h t . null? t\n  lexCons h (startPos h) nil (endPos h)\n  lexCons h (startPos h) t (endPos t)");;
  _null$e = Parse.define('null?', (function() {var f; return function _null$e(){return f || (f = (function(_x){return _false();}));}})(), 1, "\\x . false");;
  _null$e = Leisure.makeDispatchFunction('null?', '_null$e', '_x', ['_null$e', '_x']);
Leisure.createMethod('nil', 'null?', "\\x      . true", function(_x) {return _true();});
  _map = Parse.define('map', (function() {var f; return function _map(){return f || (f = (function(_func){return function(_list){return __map()((function(){var $m; return (function(){return $m || ($m = (_pairFunc()(_list)))})})())(_func)(_list);};}));}})(), 2, "\\func list . _map (pairFunc list) func list");;
  __map = Parse.define('_map', (function() {var f; return function __map(){return f || (f = (function(_pairF){return function(_func){return function(_list){return _null$e()(_list)(_nil)((function(){var $m; return (function(){return $m || ($m = (_pairF()((function(){var $m; return (function(){return $m || ($m = (_func()((function(){var $m; return (function(){return $m || ($m = (_head()(_list)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (__map()(_pairF)(_func)((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})())))})})())))})})());};};}));}})(), 3, "\\pairF func list . null? list\n  nil\n  pairF (func (head list)) (_map pairF func (tail list))");;
  _foldl = Parse.define('foldl', (function() {var f; return function _foldl(){return f || (f = (function(_func){return function(_arg){return function(_list){return _foldl()(_func)((function(){var $m; return (function(){return $m || ($m = (_func()(_arg)((function(){var $m; return (function(){return $m || ($m = (_head()(_list)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})());};};}));}})(), 3, "\\func arg list . foldl func (func arg (head list)) (tail list)");;
  _foldl = Leisure.makeDispatchFunction('foldl', '_foldl', '_list', ['_foldl', '_func', '_arg', '_list']);
Leisure.createMethod('nil', 'foldl', "\\func arg list      . arg", function(_func, _arg, _list) {return _arg();});
  _foldl1 = Parse.define('foldl1', (function() {var f; return function _foldl1(){return f || (f = (function(_func){return function(_list){return _foldl()(_func)((function(){var $m; return (function(){return $m || ($m = (_head()(_list)))})})())((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})());};}));}})(), 2, "\\func list . foldl func (head list) (tail list)");;
  _foldl1 = Leisure.makeDispatchFunction('foldl1', '_foldl1', '_list', ['_foldl1', '_func', '_list']);
Leisure.createMethod('nil', 'foldl1', "\\func list      . nil", function(_func, _list) {return _nil();});
  _foldr = Parse.define('foldr', (function() {var f; return function _foldr(){return f || (f = (function(_func){return function(_arg){return function(_list){return _null$e()(_list)(_arg)((function(){var $m; return (function(){return $m || ($m = (_func()((function(){var $m; return (function(){return $m || ($m = (_head()(_list)))})})())((function(){var $m; return (function(){return $m || ($m = (_foldr()(_func)(_arg)((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})())))})})())))})})());};};}));}})(), 3, "\\func arg list . null? list\n  arg\n  func (head list) (foldr func arg (tail list))");;
  _foldr1 = Parse.define('foldr1', (function() {var f; return function _foldr1(){return f || (f = (function(_func){return function(_list){return _eq()((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})())(_nil)((function(){var $m; return (function(){return $m || ($m = (_head()(_list)))})})())((function(){var $m; return (function(){return $m || ($m = (_func()((function(){var $m; return (function(){return $m || ($m = (_head()(_list)))})})())((function(){var $m; return (function(){return $m || ($m = (_foldr1()(_func)((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})())))})})())))})})());};}));}})(), 2, "\\func list . eq (tail list) nil\n  head list\n  func (head list) (foldr1 func (tail list))");;
  _foldr1 = Leisure.makeDispatchFunction('foldr1', '_foldr1', '_list', ['_foldr1', '_func', '_list']);
Leisure.createMethod('nil', 'foldr1', "\\func list      . nil", function(_func, _list) {return _nil();});
  _append = Parse.define('append', (function() {var f; return function _append(){return f || (f = (function(_l1){return function(_l2){return __append()((function(){var $m; return (function(){return $m || ($m = (_pairFunc()(_l1)))})})())(_l1)(_l2);};}));}})(), 2, "\\l1 l2 . _append (pairFunc l1) l1 l2");;
  _append = Leisure.makeDispatchFunction('append', '_append', '_l1', ['_append', '_l1', '_l2']);
Leisure.createMethod('nil', 'append', "\\l1      l2 . l2", function(_l1, _l2) {return _l2();});
  __append = Parse.define('_append', (function() {var f; return function __append(){return f || (f = (function(_pairF){return function(_l1){return function(_l2){return _pairF()((function(){var $m; return (function(){return $m || ($m = (_head()(_l1)))})})())((function(){var $m; return (function(){return $m || ($m = (__append()(_pairF)((function(){var $m; return (function(){return $m || ($m = (_tail()(_l1)))})})())(_l2)))})})());};};}));}})(), 3, "\\pairF l1 l2 . pairF (head l1) (_append pairF (tail l1) l2)");;
  __append = Leisure.makeDispatchFunction('_append', '__append', '_l1', ['__append', '_pairF', '_l1', '_l2']);
Leisure.createMethod('nil', '_append', "\\pairF l1      l2 . l2", function(_pairF, _l1, _l2) {return _l2();});
  _reverse = Parse.define('reverse', (function() {var f; return function _reverse(){return f || (f = (function(_l){return _subreverse()(_l)(_nil);}));}})(), 1, "\\l . subreverse l nil");;
  _subreverse = Parse.define('subreverse', (function() {var f; return function _subreverse(){return f || (f = (function(_l){return function(_result){return _l()((function(){var $m; return (function(){return $m || ($m = (function(_h){return function(_t){return function(_D){return _subreverse()(_t)((function(){var $m; return (function(){return $m || ($m = (_cons()(_h)(_result)))})})());};};}))})})())(_result);};}));}})(), 2, "\\l result . l (\\h t D . subreverse t (cons h result)) result");;
  _if = Parse.define('if', (function _if() {return ((_id()));}), 0, "id");;
  _at = Parse.define('at', (function() {var f; return function _at(){return f || (f = (function(_l){return function(_x){return _iszero()(_x)((function(){var $m; return (function(){return $m || ($m = (_head()(_l)))})})())((function(){var $m; return (function(){return $m || ($m = (_at()((function(){var $m; return (function(){return $m || ($m = (_tail()(_l)))})})())((function(){var $m; return (function(){return $m || ($m = (_$_$_()(_x)))})})())))})})());};}));}})(), 2, "\\l x . (iszero (x)) (head l) (at (tail l) (-- (x) ) )");;
  _index_combine = Parse.define('index_combine', (function() {var f; return function _index_combine(){return f || (f = (function(_x){return function(_y){return _or()((function(){var $m; return (function(){return $m || ($m = (_eq()(_x)(_nil)))})})())((function(){var $m; return (function(){return $m || ($m = (_eq()(_y)(_nil)))})})())(_nil)((function(){var $m; return (function(){return $m || ($m = (_$o()(_x)(_y)))})})());};}));}})(), 2, "\\x y . (or (eq x nil) (eq y nil)) (nil) (+ x y)");;
  _indexof = Parse.define('indexof', (function() {var f; return function _indexof(){return f || (f = (function(_l){return function(_x){return _if()((function(){var $m; return (function(){return $m || ($m = (_eq()(_l)(_nil)))})})())(_nil)((function(){var $m; return (function(){return $m || ($m = (_if()((function(){var $m; return (function(){return $m || ($m = (_eq()(_x)((function(){var $m; return (function(){return $m || ($m = (_head()(_l)))})})())))})})())((function(){return 0}))((function(){var $m; return (function(){return $m || ($m = (_index_combine()((function(){return 1}))((function(){var $m; return (function(){return $m || ($m = (_indexof()((function(){var $m; return (function(){return $m || ($m = (_tail()(_l)))})})())(_x)))})})())))})})())))})})());};}));}})(), 2, "\\l x . if (eq l nil) (nil) (if (eq x (head l)) (0) (index_combine 1 (indexof (tail l) x ) ) )");;
  _position = Parse.define('position', (function() {var f; return function _position(){return f || (f = (function(_l){return function(_x){return _indexof()(_x)(_l);};}));}})(), 2, "\\l x . indexof x l");;
  _$r = Parse.defineMacro('[', (function() {var f; return function _$r(){return f || (f = (function(_list){return _constructList()((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})());}));}})(), 1, "\\list . constructList (tail list)");;
  _constructList = Parse.define('constructList', (function() {var f; return function _constructList(){return f || (f = (function(_list){return _cl()((function(){var $m; return (function(){return $m || ($m = (_head()(_list)))})})())((function(){var $m; return (function(){return $m || ($m = (_tokString()((function(){var $m; return (function(){return $m || ($m = (_head()(_list)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})());}));}})(), 1, "\\list . cl (head list) (tokString (head list)) (tail list)");;
  _constructList = Leisure.makeDispatchFunction('constructList', '_constructList', '_list', ['_constructList', '_list']);
Leisure.createMethod('nil', 'constructList', "\\list      . nil", function(_list) {return _nil();});
  _cl = Parse.define('cl', (function() {var f; return function _cl(){return f || (f = (function(_h){return function(_hs){return function(_t){return _eq()(_hs)((function(){return "|"}))((function(){var $m; return (function(){return $m || ($m = (_eq()((function(){var $m; return (function(){return $m || ($m = (_length()(_t)))})})())((function(){return 2}))((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){var $m; return (function(){return $m || ($m = (_head()(_t)))})})())(_nil)))})})())((function(){var $m; return (function(){return $m || ($m = (_error()((function(){return "Bad list format."}))))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_eq()(_hs)((function(){return "]"}))((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){return "nil"}))(_nil)))})})())((function(){var $m; return (function(){return $m || ($m = (_eq()(_hs)((function(){return ","}))((function(){var $m; return (function(){return $m || ($m = (_constructList()(_t)))})})())((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){return "cons"}))((function(){var $m; return (function(){return $m || ($m = (_cons()(_h)((function(){var $m; return (function(){return $m || ($m = (_constructList()(_t)))})})())))})})())))})})())(_nil)))})})())))})})())))})})());};};}));}})(), 3, "\\h hs t . eq hs '|'\n  eq (length t) 2\n    # -- scanner ensures: eq (tokString (head (tail t))) ']'\n    cons (head t) nil\n    error \"Bad list format.\"\n  eq hs ']'\n    # -- scanner ensures: eq t nil\n    cons 'nil' nil\n    eq hs ','\n      constructList t\n      cons (cons 'cons' (cons h (constructList t))) nil");;
  _tokString = Parse.define('tokString', (function() {var f; return function _tokString(){return f || (f = (function(_x){return _x();}));}})(), 1, "\\x . x");;
  _tokString = Leisure.makeDispatchFunction('tokString', '_tokString', '_t', ['_tokString', '_t']);
Leisure.createMethod('token', 'tokString', "\\t        . t \\t p . t", function(_t) {return _t()((function(){var $m; return (function(){return $m || ($m = (function(_t){return function(_p){return _t();};}))})})());});
  _identMacro = Parse.defineMacro('identMacro', (function() {var f; return function _identMacro(){return f || (f = (function(_list){return _tail()(_list);}));}})(), 1, "\\list . tail list");;
  _macroCons = Parse.defineMacro('macroCons', (function() {var f; return function _macroCons(){return f || (f = (function(_list){return _cons()((function(){return "cons"}))((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})());}));}})(), 1, "\\list . cons 'cons' (tail list)");;
  _concat$r = Parse.defineMacro('concat[', (function() {var f; return function _concat$r(){return f || (f = (function(_list){return _cons()((function(){var $m; return (function(){return $m || ($m = (_token()((function(){return "concat"}))((function(){var $m; return (function(){return $m || ($m = (_tokenStart()(_list)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){var $m; return (function(){return $m || ($m = (_token()((function(){return "["}))((function(){var $m; return (function(){return $m || ($m = (_tokenStart()((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})())))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})())))})})())(_nil)))})})());}));}})(), 1, "\\list . cons (token 'concat' (tokenStart list)) (cons (cons (token '[' (tokenStart (tail list))) (tail list)) nil)");;
  _intersperse = Parse.define('intersperse', (function() {var f; return function _intersperse(){return f || (f = (function(_x){return function(_l){return _or()((function(){var $m; return (function(){return $m || ($m = (_eq()(_l)(_nil)))})})())((function(){var $m; return (function(){return $m || ($m = (_eq()((function(){var $m; return (function(){return $m || ($m = (_tail()(_l)))})})())(_nil)))})})())(_l)((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){var $m; return (function(){return $m || ($m = (_head()(_l)))})})())((function(){var $m; return (function(){return $m || ($m = (_cons()(_x)((function(){var $m; return (function(){return $m || ($m = (_intersperse()(_x)((function(){var $m; return (function(){return $m || ($m = (_tail()(_l)))})})())))})})())))})})())))})})());};}));}})(), 2, "\\x l . or (eq l nil) (eq (tail l) nil) l [(head l) x | (intersperse x (tail l))]");;
  _intercalate = Parse.define('intercalate', (function() {var f; return function _intercalate(){return f || (f = (function(_x){return function(_l){return _concat()((function(){var $m; return (function(){return $m || ($m = (_intersperse()(_x)(_l)))})})());};}));}})(), 2, "\\x l . concat (intersperse x l)");;
  _agent = Parse.define('agent', (function() {var f; return function _agent(){return f || (f = (function(_name){return _primagent()(_name)(_nil)((function(){var $m; return (function(){return $m || ($m = (function(_prev){return function(_block){return _block()(_prev);};}))})})());}));}})(), 1, "\\name . primagent name nil \\prev block . block prev");;
  _sendMonad = Parse.define('sendMonad', (function() {var f; return function _sendMonad(){return f || (f = (function(_value){return function(_monad){return _send()(_value)((function(){return "io"}))(_monad);};}));}})(), 2, "\\value monad . send value 'io' monad");;
  _log = Parse.define('log', (function() {var f; return function _log(){return f || (f = (function(_value){return function(_msg){return _sendMonad()(_value)((function(){var $m; return (function(){return $m || ($m = (_print()(_msg)))})})());};}));}})(), 2, "\\value msg . sendMonad value (print msg)");;
  _doFilter = Parse.define('doFilter', (function() {var f; return function _doFilter(){return f || (f = (function(_parseDefs){return function(_list){return _transformDo()(_list);};}));}})(), 2, "\\parseDefs list . transformDo list");;
  _transformDo = Parse.define('transformDo', (function() {var f; return function _transformDo(){return f || (f = (function(_list){return _list();}));}})(), 1, "\\list . list");;
  _transformDo = Leisure.makeDispatchFunction('transformDo', '_transformDo', '_list', ['_transformDo', '_list']);
Leisure.createMethod('cons', 'transformDo', "\\list       . subDos list", function(_list) {return _subDos()(_list);});
  _transformDo = Leisure.makeDispatchFunction('transformDo', '_transformDo', '_list', ['_transformDo', '_list']);
Leisure.createMethod('lexCons', 'transformDo', "\\list          . subDos list", function(_list) {return _subDos()(_list);});
  _subDos = Parse.define('subDos', (function() {var f; return function _subDos(){return f || (f = (function(_list){return _eq()((function(){return "do"}))((function(){var $m; return (function(){return $m || ($m = (_tokString()((function(){var $m; return (function(){return $m || ($m = (_head()(_list)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_foldr1()((function(){var $m; return (function(){return $m || ($m = (function(_el){return _doClause()(_el);}))})})())((function(){var $m; return (function(){return $m || ($m = (_subNextDos()((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})())))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_subNextDos()(_list)))})})());}));}})(), 1, "\\list . eq 'do' (tokString (head list))\n  foldr1 (\\el . doClause el) (subNextDos (tail list))\n  subNextDos list");;
  _subNextDos = Parse.define('subNextDos', (function() {var f; return function _subNextDos(){return f || (f = (function(_nonlist){return _nonlist();}));}})(), 1, "\\nonlist . nonlist");;
  _subNextDos = Leisure.makeDispatchFunction('subNextDos', '_subNextDos', '_list', ['_subNextDos', '_list']);
Leisure.createMethod('cons', 'subNextDos', "\\list       . listSubNextDos list", function(_list) {return _listSubNextDos()(_list);});
  _subNextDos = Leisure.makeDispatchFunction('subNextDos', '_subNextDos', '_list', ['_subNextDos', '_list']);
Leisure.createMethod('lexCons', 'subNextDos', "\\list          . listSubNextDos list", function(_list) {return _listSubNextDos()(_list);});
  _listSubNextDos = Parse.define('listSubNextDos', (function() {var f; return function _listSubNextDos(){return f || (f = (function(_list){return _eq()((function(){return "."}))((function(){var $m; return (function(){return $m || ($m = (_tokString()((function(){var $m; return (function(){return $m || ($m = (_head()(_list)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){var $m; return (function(){return $m || ($m = (_head()(_list)))})})())((function(){var $m; return (function(){return $m || ($m = (_transformDo()((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})())))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){var $m; return (function(){return $m || ($m = (_transformDo()((function(){var $m; return (function(){return $m || ($m = (_head()(_list)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_subNextDos()((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})())))})})())))})})());}));}})(), 1, "\\list . eq '.' (tokString (head list))\n  cons (head list) (transformDo (tail list))\n  cons (transformDo (head list)) (subNextDos (tail list))");;
  _doClause = Parse.define('doClause', (function() {var f; return function _doClause(){return f || (f = (function(_clause){return function(_rest){return _doExtractVar()(_clause)((function(){return "<-"}))((function(){var $m; return (function(){return $m || ($m = (function(_var){return _cons()((function(){return "bind"}))((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){var $m; return (function(){return $m || ($m = (_tail()((function(){var $m; return (function(){return $m || ($m = (_tail()(_clause)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){return "\\"}))((function(){var $m; return (function(){return $m || ($m = (_cons()(_var)((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){return "."}))((function(){var $m; return (function(){return $m || ($m = (_cons()(_rest)(_nil)))})})())))})})())))})})())))})})())))})})());}))})})())((function(){var $m; return (function(){return $m || ($m = (_doExtractVar()(_clause)((function(){return "="}))((function(){var $m; return (function(){return $m || ($m = (function(_var){return _cons()((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){return "\\"}))((function(){var $m; return (function(){return $m || ($m = (_cons()(_var)((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){return "."}))((function(){var $m; return (function(){return $m || ($m = (_cons()(_rest)(_nil)))})})())))})})())))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){var $m; return (function(){return $m || ($m = (_tail()((function(){var $m; return (function(){return $m || ($m = (_tail()(_clause)))})})())))})})())(_nil)))})})());}))})})())((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){return "bind"}))((function(){var $m; return (function(){return $m || ($m = (_cons()(_clause)((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){return "\\"}))((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){return "_"}))((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){return "."}))((function(){var $m; return (function(){return $m || ($m = (_cons()(_rest)(_nil)))})})())))})})())))})})())))})})())))})})())))})})())))})})());};}));}})(), 2, "\\clause rest . doExtractVar clause '<-'\n  \\var . cons 'bind' (cons (tail (tail clause)) (cons '\\\\' (cons var (cons '.' (cons rest nil)))))\n  doExtractVar clause '='\n    \\var . cons (cons '\\\\' (cons var (cons '.' (cons rest nil)))) (cons (tail (tail clause)) nil)\n    cons 'bind' (cons clause (cons '\\\\' (cons '_' (cons '.' (cons rest nil)))))");;
  _doExtractVar = Parse.define('doExtractVar', (function() {var f; return function _doExtractVar(){return f || (f = (function(_list){return function(_tokName){return _none();};}));}})(), 2, "\\list tokName . none");;
  _doExtractVar = Leisure.makeDispatchFunction('doExtractVar', '_doExtractVar', '_list', ['_doExtractVar', '_list', '_tokName']);
Leisure.createMethod('cons', 'doExtractVar', "\\list       tokName . listDoExtractVar list tokName", function(_list, _tokName) {return _listDoExtractVar()(_list)(_tokName);});
  _doExtractVar = Leisure.makeDispatchFunction('doExtractVar', '_doExtractVar', '_list', ['_doExtractVar', '_list', '_tokName']);
Leisure.createMethod('lexCons', 'doExtractVar', "\\list          tokName . listDoExtractVar list tokName", function(_list, _tokName) {return _listDoExtractVar()(_list)(_tokName);});
  _listDoExtractVar = Parse.define('listDoExtractVar', (function() {var f; return function _listDoExtractVar(){return f || (f = (function(_list){return function(_tokName){return _or()((function(){var $m; return (function(){return $m || ($m = (_null$e()((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_neq()(_tokName)((function(){var $m; return (function(){return $m || ($m = (_tokString()((function(){var $m; return (function(){return $m || ($m = (_head()((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})())))})})())))})})())))})})())(_none)((function(){var $m; return (function(){return $m || ($m = (_some()((function(){var $m; return (function(){return $m || ($m = (_head()(_list)))})})())))})})());};}));}})(), 2, "\\list tokName . or (null? (tail list)) (neq tokName (tokString (head (tail list))))\n  none\n  some (head list)");;
})
.andThen(function(){ return   (_addParseFilter()(_doFilter))})
.andThen(function(){ return   (_bind()((function(){var $m; return (function(){return $m || ($m = (_defGroup()((function(){return "or["}))((function(){return "]"}))))})})())((function(){var $m; return (function(){return $m || ($m = (function(__){return _defGroup()((function(){return "and["}))((function(){return "]"}));}))})})()))})
.andThen(function(){
  _dlempty = Parse.define('dlempty', (function _dlempty() {return ((_id()));}), 0, "id");;
  _dl = Parse.define('dl', (function() {var f; return function _dl(){return f || (f = (Parse.setDataType(function(_item){return Parse.setType(function(_rest){return _cons()(_item)(_rest);}, 'dl');}, 'dl')));}})(), 1, "\\item . \\rest . [item | rest]");;
  _dlPush = Parse.define('dlPush', (function() {var f; return function _dlPush(){return f || (f = (function(_list){return function(_item){return _dlAppend()(_list)((function(){var $m; return (function(){return $m || ($m = (_dl()(_item)))})})());};}));}})(), 2, "\\list item . dlAppend list (dl item)");;
  _dlAppend = Parse.define('dlAppend', (function() {var f; return function _dlAppend(){return f || (f = (Parse.setDataType(function(_a){return function(_b){return Parse.setType(function(_rest){return _a()((function(){var $m; return (function(){return $m || ($m = (_b()(_rest)))})})());}, 'dlAppend');};}, 'dlAppend')));}})(), 2, "\\a b . \\rest . a (b rest)");;
  _flatten = Parse.define('flatten', (function() {var f; return function _flatten(){return f || (f = (function(_list){return _subflatten()(_list)(_nil);}));}})(), 1, "\\list . subflatten list nil");;
  _subflatten = Parse.define('subflatten', (function() {var f; return function _subflatten(){return f || (f = (function(_list){return _isStream()(_list)((function(){var $m; return (function(){return $m || ($m = (_dlAppend()((function(){var $m; return (function(){return $m || ($m = (_subflatten()((function(){var $m; return (function(){return $m || ($m = (_head()(_list)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_subflatten()((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})())))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_dl()(_list)))})})());}));}})(), 1, "\\list . isStream list\n  dlAppend (subflatten (head list)) (subflatten (tail list))\n  dl list");;
  _subflatten = Leisure.makeDispatchFunction('subflatten', '_subflatten', '_list', ['_subflatten', '_list']);
Leisure.createMethod('nil', 'subflatten', "\\list      . dlempty", function(_list) {return _dlempty();});
  _remove = Parse.define('remove', (function() {var f; return function _remove(){return f || (f = (function(_x){return function(_l){return _removeIf()((function(){var $m; return (function(){return $m || ($m = (_eq()(_x)))})})())(_l);};}));}})(), 2, "\\x l . removeIf (eq x) l");;
  _removeIf = Parse.define('removeIf', (function() {var f; return function _removeIf(){return f || (f = (function(_f){return function(_l){return __removeIf()((function(){var $m; return (function(){return $m || ($m = (_pairFunc()(_l)))})})())(_f)(_l);};}));}})(), 2, "\\f l . _removeIf (pairFunc l) f l");;
  __removeIf = Parse.define('_removeIf', (function() {var f; return function __removeIf(){return f || (f = (function(_pairF){return function(_f){return function(_l){return _if()((function(){var $m; return (function(){return $m || ($m = (_eq()(_l)(_nil)))})})())(_nil)((function(){var $m; return (function(){return $m || ($m = (_if()((function(){var $m; return (function(){return $m || ($m = (_f()((function(){var $m; return (function(){return $m || ($m = (_head()(_l)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (__removeIf()(_pairF)(_f)((function(){var $m; return (function(){return $m || ($m = (_tail()(_l)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_pairF()((function(){var $m; return (function(){return $m || ($m = (_head()(_l)))})})())((function(){var $m; return (function(){return $m || ($m = (__removeIf()(_pairF)(_f)((function(){var $m; return (function(){return $m || ($m = (_tail()(_l)))})})())))})})())))})})())))})})());};};}));}})(), 3, "\\pairF f l . if (eq l nil) nil\n  if (f (head l)) (_removeIf pairF f (tail l))\n    pairF (head l) (_removeIf pairF f (tail l))");;
  _removeIfNot = Parse.define('removeIfNot', (function() {var f; return function _removeIfNot(){return f || (f = (function(_f){return function(_l){return _removeIf()((function(){var $m; return (function(){return $m || ($m = (function(_x){return _not()((function(){var $m; return (function(){return $m || ($m = (_f()(_x)))})})());}))})})())(_l);};}));}})(), 2, "\\f l . removeIf (\\x. not (f x)) l");;
  _filter = Parse.define('filter', (function() {var f; return function _filter(){return f || (f = (function(_f){return _removeIf()((function(){var $m; return (function(){return $m || ($m = (_compose()(_not)(_f)))})})());}));}})(), 1, "\\f . removeIf (compose not f)");;
  _any = Parse.define('any', (function() {var f; return function _any(){return f || (f = (function(_f){return function(_l){return __any()((function(){var $m; return (function(){return $m || ($m = (_pairFunc()(_l)))})})())(_f)(_l);};}));}})(), 2, "\\f l . _any (pairFunc l) f l");;
  __any = Parse.define('_any', (function() {var f; return function __any(){return f || (f = (function(_pairF){return function(_f){return function(_l){return _null$e()(_l)(_false)((function(){var $m; return (function(){return $m || ($m = (_or()((function(){var $m; return (function(){return $m || ($m = (_f()((function(){var $m; return (function(){return $m || ($m = (_head()(_l)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (__any()(_pairF)(_f)((function(){var $m; return (function(){return $m || ($m = (_tail()(_l)))})})())))})})())))})})());};};}));}})(), 3, "\\pairF f l . null? l\n  false\n  or\n    f (head l)\n    _any pairF f (tail l)");;
  _all = Parse.define('all', (function() {var f; return function _all(){return f || (f = (function(_f){return function(_l){return __all()((function(){var $m; return (function(){return $m || ($m = (_pairFunc()(_l)))})})())(_f)(_l);};}));}})(), 2, "\\f l . _all (pairFunc l) f l");;
  __all = Parse.define('_all', (function() {var f; return function __all(){return f || (f = (function(_pairF){return function(_f){return function(_l){return _null$e()(_l)(_true)((function(){var $m; return (function(){return $m || ($m = (_and()((function(){var $m; return (function(){return $m || ($m = (_f()((function(){var $m; return (function(){return $m || ($m = (_head()(_l)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (__all()(_pairF)(_f)((function(){var $m; return (function(){return $m || ($m = (_tail()(_l)))})})())))})})())))})})());};};}));}})(), 3, "\\pairF f l . null? l\n  true\n  and\n    f (head l)\n    _all pairF f (tail l)");;
  _find = Parse.define('find', (function() {var f; return function _find(){return f || (f = (function(_x){return function(_l){return _findIf()((function(){var $m; return (function(){return $m || ($m = (_eq()(_x)))})})())(_l);};}));}})(), 2, "\\x l . findIf (eq x) l");;
  _findIf = Parse.define('findIf', (function() {var f; return function _findIf(){return f || (f = (function(_f){return function(_l){return _null$e()(_l)(_nil)((function(){var $m; return (function(){return $m || ($m = (_f()((function(){var $m; return (function(){return $m || ($m = (_head()(_l)))})})())((function(){var $m; return (function(){return $m || ($m = (_head()(_l)))})})())((function(){var $m; return (function(){return $m || ($m = (_findIf()(_f)((function(){var $m; return (function(){return $m || ($m = (_tail()(_l)))})})())))})})())))})})());};}));}})(), 2, "\\f l . null? l\n  nil\n  f (head l)\n    head l\n    findIf f (tail l)");;
  _findIfOpt = Parse.define('findIfOpt', (function() {var f; return function _findIfOpt(){return f || (f = (function(_f){return function(_l){return _null$e()(_l)(_none)((function(){var $m; return (function(){return $m || ($m = (_f()((function(){var $m; return (function(){return $m || ($m = (_head()(_l)))})})())((function(){var $m; return (function(){return $m || ($m = (_some()((function(){var $m; return (function(){return $m || ($m = (_head()(_l)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_findIfOpt()(_f)((function(){var $m; return (function(){return $m || ($m = (_tail()(_l)))})})())))})})())))})})());};}));}})(), 2, "\\f l . null? l\n  none\n  f (head l)\n    some (head l)\n    findIfOpt f (tail l)");;
  _findIndex = Parse.define('findIndex', (function() {var f; return function _findIndex(){return f || (f = (function(_func){return function(_list){return _subFindIndex()((function(){return 0}))(_func)(_list);};}));}})(), 2, "\\func list . subFindIndex 0 func list");;
  _subFindIndex = Parse.define('subFindIndex', (function() {var f; return function _subFindIndex(){return f || (f = (function(_index){return function(_func){return function(_list){return _func()((function(){var $m; return (function(){return $m || ($m = (_head()(_list)))})})())(_index)((function(){var $m; return (function(){return $m || ($m = (_subFindIndex()((function(){var $m; return (function(){return $m || ($m = (_$o()((function(){return 1}))(_index)))})})())(_func)((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})())))})})());};};}));}})(), 3, "\\index func list . func (head list)\n  index\n  subFindIndex (+ 1 index) func (tail list)");;
  _subFindIndex = Leisure.makeDispatchFunction('subFindIndex', '_subFindIndex', '_list', ['_subFindIndex', '_index', '_func', '_list']);
Leisure.createMethod('nil', 'subFindIndex', "\\index func list      . -1", function(_index, _func, _list) {return -1;});
  _take = Parse.define('take', (function() {var f; return function _take(){return f || (f = (function(_n){return function(_list){return __take()((function(){var $m; return (function(){return $m || ($m = (_pairFunc()(_list)))})})())(_n)(_list);};}));}})(), 2, "\\n list . _take (pairFunc list) n list");;
  __take = Parse.define('_take', (function() {var f; return function __take(){return f || (f = (function(_pairF){return function(_n){return function(_list){return _positive()(_n)((function(){var $m; return (function(){return $m || ($m = (_null$e()(_list)(_nil)((function(){var $m; return (function(){return $m || ($m = (_pairF()((function(){var $m; return (function(){return $m || ($m = (_head()(_list)))})})())((function(){var $m; return (function(){return $m || ($m = (__take()(_pairF)((function(){var $m; return (function(){return $m || ($m = (_$_$_()(_n)))})})())((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})())))})})())))})})())))})})())(_nil);};};}));}})(), 3, "\\pairF n list . positive n\n  null? list\n    nil\n    pairF (head list) (_take pairF (-- n) (tail list))\n  nil");;
  _takeWhile = Parse.define('takeWhile', (function() {var f; return function _takeWhile(){return f || (f = (function(_predicate){return function(_list){return __takeWhile()((function(){var $m; return (function(){return $m || ($m = (_pairFunc()(_list)))})})())(_predicate)(_list);};}));}})(), 2, "\\predicate list . _takeWhile (pairFunc list) predicate list");;
  __takeWhile = Parse.define('_takeWhile', (function() {var f; return function __takeWhile(){return f || (f = (function(_pairF){return function(_predicate){return function(_list){return _null$e()(_list)(_nil)((function(){var $m; return (function(){return $m || ($m = (_predicate()((function(){var $m; return (function(){return $m || ($m = (_head()(_list)))})})())((function(){var $m; return (function(){return $m || ($m = (_pairF()((function(){var $m; return (function(){return $m || ($m = (_head()(_list)))})})())((function(){var $m; return (function(){return $m || ($m = (__takeWhile()(_pairF)(_predicate)((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})())))})})())))})})())(_nil)))})})());};};}));}})(), 3, "\\pairF predicate list . null? list\n  nil\n  predicate (head list)\n    pairF (head list) (_takeWhile pairF predicate (tail list))\n    nil");;
  _drop = Parse.define('drop', (function() {var f; return function _drop(){return f || (f = (function(_x){return function(_list){return _positive()(_x)((function(){var $m; return (function(){return $m || ($m = (_null$e()(_list)(_nil)((function(){var $m; return (function(){return $m || ($m = (_drop()((function(){var $m; return (function(){return $m || ($m = (_$_$_()(_x)))})})())((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})())))})})())))})})())(_list);};}));}})(), 2, "\\x list . positive x\n  null? list\n    nil\n    drop (-- x) (tail list)\n  list");;
  _dropWhile = Parse.define('dropWhile', (function() {var f; return function _dropWhile(){return f || (f = (function(_predicate){return function(_list){return _null$e()(_list)(_nil)((function(){var $m; return (function(){return $m || ($m = (_predicate()((function(){var $m; return (function(){return $m || ($m = (_head()(_list)))})})())((function(){var $m; return (function(){return $m || ($m = (_dropWhile()(_predicate)((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})())))})})())(_list)))})})());};}));}})(), 2, "\\predicate list . null? list\n  nil\n  predicate (head list)\n    dropWhile predicate (tail list)\n    list");;
  _dropLast = Parse.define('dropLast', (function() {var f; return function _dropLast(){return f || (f = (function(_n){return function(_list){return _tail()((function(){var $m; return (function(){return $m || ($m = (__dropLast()((function(){var $m; return (function(){return $m || ($m = (_pairFunc()(_list)))})})())(_n)(_list)))})})());};}));}})(), 2, "\\n list . tail (_dropLast (pairFunc list) n list)");;
  __dropLast = Parse.define('_dropLast', (function() {var f; return function __dropLast(){return f || (f = (function(_pairF){return function(_n){return function(_list){return _eq()(_list)(_nil)((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){return 0}))(_nil)))})})())((function(){var $m; return (function(){return $m || ($m = (function(_next){return _gt()(_n)((function(){var $m; return (function(){return $m || ($m = (_head()(_next)))})})())((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){var $m; return (function(){return $m || ($m = (_$o()((function(){return 1}))((function(){var $m; return (function(){return $m || ($m = (_head()(_next)))})})())))})})())(_nil)))})})())((function(){var $m; return (function(){return $m || ($m = (_cons()(_n)((function(){var $m; return (function(){return $m || ($m = (_pairF()((function(){var $m; return (function(){return $m || ($m = (_head()(_list)))})})())((function(){var $m; return (function(){return $m || ($m = (_tail()(_next)))})})())))})})())))})})());}((function(){var $m; return (function(){return $m || ($m = (__dropLast()(_pairF)(_n)((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})())))})})())))})})());};};}));}})(), 3, "\\pairF n list . eq list nil\n  [0]\n  (\\next . gt n (head next)\n    [(+ 1 (head next))]\n    [n | (pairF (head list) (tail next))]) (_dropLast pairF n (tail list))");;
  _series = Parse.define('series', (function() {var f; return function _series(){return f || (f = (function(_func){return function(_n){return _cons()(_n)((function(){var $m; return (function(){return $m || ($m = (_series()(_func)((function(){var $m; return (function(){return $m || ($m = (_func()(_n)))})})())))})})());};}));}})(), 2, "\\func n . [n | (series func (func n))]");;
  _from = Parse.define('from', (function() {var f; return function _from(){return f || (f = (function(_n){return _series()(_$o$o)(_n);}));}})(), 1, "\\n . series ++ n");;
  _fromBy = Parse.define('fromBy', (function() {var f; return function _fromBy(){return f || (f = (function(_n){return function(_inc){return _series()((function(){var $m; return (function(){return $m || ($m = (_$o()(_inc)))})})())(_n);};}));}})(), 2, "\\n inc . series (+ inc) n");;
  _fromTo = Parse.define('fromTo', (function() {var f; return function _fromTo(){return f || (f = (function(_n){return function(_m){return _takeWhile()((function(){var $m; return (function(){return $m || ($m = (_$z()(_m)))})})())((function(){var $m; return (function(){return $m || ($m = (_from()(_n)))})})());};}));}})(), 2, "\\n m . takeWhile (> m) (from n)");;
  _fromToBy = Parse.define('fromToBy', (function() {var f; return function _fromToBy(){return f || (f = (function(_n){return function(_m){return function(_inc){return _takeWhile()((function(){var $m; return (function(){return $m || ($m = (_$z()(_m)))})})())((function(){var $m; return (function(){return $m || ($m = (_fromBy()(_n)(_inc)))})})());};};}));}})(), 3, "\\n m inc . takeWhile (> m) (fromBy n inc)");;
  _count = Parse.define('count', (function() {var f; return function _count(){return f || (f = (function(_x){return function(_l){return _countIf()((function(){var $m; return (function(){return $m || ($m = (_eq()(_x)))})})())(_l);};}));}})(), 2, "\\x l . countIf (eq x) l");;
  _countIf = Parse.define('countIf', (function() {var f; return function _countIf(){return f || (f = (function(_f){return function(_l){return _if()((function(){var $m; return (function(){return $m || ($m = (_eq()(_l)(_nil)))})})())((function(){return 0}))((function(){var $m; return (function(){return $m || ($m = (_$o()((function(){var $m; return (function(){return $m || ($m = (_f()((function(){var $m; return (function(){return $m || ($m = (_head()(_l)))})})())((function(){return 1}))((function(){return 0}))))})})())((function(){var $m; return (function(){return $m || ($m = (_countIf()(_f)((function(){var $m; return (function(){return $m || ($m = (_tail()(_l)))})})())))})})())))})})());};}));}})(), 2, "\\f l . if (eq l nil) 0\n  + (f (head l) 1 0) (countIf f (tail l))");;
  _countIfNot = Parse.define('countIfNot', (function() {var f; return function _countIfNot(){return f || (f = (function(_f){return function(_l){return _countIf()((function(){var $m; return (function(){return $m || ($m = (function(_x){return _not()((function(){var $m; return (function(){return $m || ($m = (_f()(_x)))})})());}))})})())(_l);};}));}})(), 2, "\\f l . countIf (\\x. not (f x)) l");;
  _odds = Parse.define('odds', (function() {var f; return function _odds(){return f || (f = (function(_l){return _cons()((function(){var $m; return (function(){return $m || ($m = (_head()(_l)))})})())((function(){var $m; return (function(){return $m || ($m = (_evens()((function(){var $m; return (function(){return $m || ($m = (_tail()(_l)))})})())))})})());}));}})(), 1, "\\l . [(head l) | (evens (tail l))]");;
  _odds = Leisure.makeDispatchFunction('odds', '_odds', '_l', ['_odds', '_l']);
Leisure.createMethod('nil', 'odds', "\\l      . nil", function(_l) {return _nil();});
  _evens = Parse.define('evens', (function() {var f; return function _evens(){return f || (f = (function(_l){return _odds()((function(){var $m; return (function(){return $m || ($m = (_tail()(_l)))})})());}));}})(), 1, "\\l . odds (tail l)");;
  _evens = Leisure.makeDispatchFunction('evens', '_evens', '_l', ['_evens', '_l']);
Leisure.createMethod('nil', 'evens', "\\l      . nil", function(_l) {return _nil();});
  _cleave = Parse.define('cleave', (function() {var f; return function _cleave(){return f || (f = (function(_l){return _cons()((function(){var $m; return (function(){return $m || ($m = (_evens()(_l)))})})())((function(){var $m; return (function(){return $m || ($m = (_odds()(_l)))})})());}));}})(), 1, "\\l . [(evens l) | (odds l)]");;
  _merge = Parse.define('merge', (function() {var f; return function _merge(){return f || (f = (function(_cmp){return function(_a){return function(_b){return _submerge()(_cmp)(_b)(_a);};};}));}})(), 3, "\\cmp a b . submerge cmp b a");;
  _merge = Leisure.makeDispatchFunction('merge', '_merge', '_b', ['_merge', '_cmp', '_a', '_b']);
Leisure.createMethod('nil', 'merge', "\\cmp a b      . a", function(_cmp, _a, _b) {return _a();});
  _submerge = Parse.define('submerge', (function() {var f; return function _submerge(){return f || (f = (function(_cmp){return function(_a){return function(_b){return _cmp()((function(){var $m; return (function(){return $m || ($m = (_head()(_a)))})})())((function(){var $m; return (function(){return $m || ($m = (_head()(_b)))})})())((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){var $m; return (function(){return $m || ($m = (_head()(_a)))})})())((function(){var $m; return (function(){return $m || ($m = (_merge()(_cmp)((function(){var $m; return (function(){return $m || ($m = (_tail()(_a)))})})())(_b)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){var $m; return (function(){return $m || ($m = (_head()(_b)))})})())((function(){var $m; return (function(){return $m || ($m = (_merge()(_cmp)(_a)((function(){var $m; return (function(){return $m || ($m = (_tail()(_b)))})})())))})})())))})})());};};}));}})(), 3, "\\cmp a b . cmp (head a) (head b)\n  [(head a) | (merge cmp (tail a) b)]\n  [(head b) | (merge cmp a (tail b))]");;
  _submerge = Leisure.makeDispatchFunction('submerge', '_submerge', '_b', ['_submerge', '_cmp', '_a', '_b']);
Leisure.createMethod('nil', 'submerge', "\\cmp a b      . a", function(_cmp, _a, _b) {return _a();});
  _mergeSort = Parse.define('mergeSort', (function() {var f; return function _mergeSort(){return f || (f = (function(_cmp){return function(_l){return _eq()((function(){var $m; return (function(){return $m || ($m = (_tail()(_l)))})})())(_nil)(_l)((function(){var $m; return (function(){return $m || ($m = (function(_cl){return function(_e){return function(_o){return _merge()(_cmp)((function(){var $m; return (function(){return $m || ($m = (_mergeSort()(_cmp)(_e)))})})())((function(){var $m; return (function(){return $m || ($m = (_mergeSort()(_cmp)(_o)))})})());}((function(){var $m; return (function(){return $m || ($m = (_tail()(_cl)))})})());}((function(){var $m; return (function(){return $m || ($m = (_head()(_cl)))})})());}((function(){var $m; return (function(){return $m || ($m = (_cleave()(_l)))})})())))})})());};}));}})(), 2, "\\cmp l . eq (tail l) nil\n  l\n  do\n    cl = cleave l\n    e = head cl\n    o = tail cl\n    merge cmp (mergeSort cmp e) (mergeSort cmp o)");;
  _mergeSort = Leisure.makeDispatchFunction('mergeSort', '_mergeSort', '_l', ['_mergeSort', '_cmp', '_l']);
Leisure.createMethod('nil', 'mergeSort', "\\cmp l      . nil", function(_cmp, _l) {return _nil();});
  _sort = Parse.define('sort', (function() {var f; return function _sort(){return f || (f = (function(_l){return _sortBy()(_lte)(_l);}));}})(), 1, "\\l . sortBy lte l");;
  _sortBy = Parse.define('sortBy', (function() {var f; return function _sortBy(){return f || (f = (function(_cmp){return function(_l){return _mergeSort()(_cmp)(_l);};}));}})(), 2, "\\cmp l . mergeSort cmp l");;
  _assocFromList = Parse.define('assocFromList', (function() {var f; return function _assocFromList(){return f || (f = (function(_l){return _if()((function(){var $m; return (function(){return $m || ($m = (_null$e()(_l)))})})())(_nil)((function(){var $m; return (function(){return $m || ($m = (_assocSet()((function(){var $m; return (function(){return $m || ($m = (_head()(_l)))})})())((function(){var $m; return (function(){return $m || ($m = (_head()((function(){var $m; return (function(){return $m || ($m = (_tail()(_l)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_assocFromList()((function(){var $m; return (function(){return $m || ($m = (_tail()((function(){var $m; return (function(){return $m || ($m = (_tail()(_l)))})})())))})})())))})})())))})})());}));}})(), 1, "\\l . if (null? l) nil\n  assocSet (head l) (head (tail l)) (assocFromList (tail (tail l)))");;
  _assocKey = Parse.define('assocKey', (function() {var f; return function _assocKey(){return f || (f = (function(_cons){return _head()(_cons);}));}})(), 1, "\\cons . head cons");;
  _assocValue = Parse.define('assocValue', (function() {var f; return function _assocValue(){return f || (f = (function(_cons){return _tail()(_cons);}));}})(), 1, "\\cons . tail cons");;
  _assocGetPair = Parse.define('assocGetPair', (function() {var f; return function _assocGetPair(){return f || (f = (function(_k){return function(_anAssoc){return _findIf()((function(){var $m; return (function(){return $m || ($m = (function(_x){return _eq()((function(){var $m; return (function(){return $m || ($m = (_head()(_x)))})})())(_k);}))})})())(_anAssoc);};}));}})(), 2, "\\k anAssoc . findIf (\\x . eq (head x) k) anAssoc");;
  _assocGetPairOpt = Parse.define('assocGetPairOpt', (function() {var f; return function _assocGetPairOpt(){return f || (f = (function(_k){return function(_l){return _l()((function(){var $m; return (function(){return $m || ($m = (function(_h){return function(_t){return function(_D){return _h()((function(){var $m; return (function(){return $m || ($m = (function(_kk){return function(_vv){return _eq()(_k)(_kk)((function(){var $m; return (function(){return $m || ($m = (_some2()(_kk)(_vv)))})})())((function(){var $m; return (function(){return $m || ($m = (_assocGetPairOpt()(_k)(_t)))})})());};}))})})());};};}))})})())(_none);};}));}})(), 2, "\\k l . l (\\h t D . h (\\kk vv . (eq k kk) (some2 kk vv) (assocGetPairOpt k t))) none");;
  _assocKeys = Parse.define('assocKeys', (function() {var f; return function _assocKeys(){return f || (f = (function(_anAssoc){return _map()((function(){var $m; return (function(){return $m || ($m = (function(_cell){return _assocKey()(_cell);}))})})())(_anAssoc);}));}})(), 1, "\\anAssoc . map (\\cell . (assocKey cell)) anAssoc");;
  _assocNumKeys = Parse.define('assocNumKeys', (function() {var f; return function _assocNumKeys(){return f || (f = (function(_anAssoc){return _length()((function(){var $m; return (function(){return $m || ($m = (_assocKeys()(_anAssoc)))})})());}));}})(), 1, "\\anAssoc . length (assocKeys anAssoc)");;
  _assocMergeKeys = Parse.define('assocMergeKeys', (function() {var f; return function _assocMergeKeys(){return f || (f = (function(_hm1){return function(_hm2){return function(_keys){return _if()((function(){var $m; return (function(){return $m || ($m = (_null$e()(_keys)))})})())(_hm1)((function(){var $m; return (function(){return $m || ($m = (_if()((function(){var $m; return (function(){return $m || ($m = (_null$e()((function(){var $m; return (function(){return $m || ($m = (_assocGetPair()((function(){var $m; return (function(){return $m || ($m = (_head()(_keys)))})})())(_hm1)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){var $m; return (function(){return $m || ($m = (_assocGetPair()((function(){var $m; return (function(){return $m || ($m = (_head()(_keys)))})})())(_hm2)))})})())((function(){var $m; return (function(){return $m || ($m = (_assocMergeKeys()(_hm1)(_hm2)((function(){var $m; return (function(){return $m || ($m = (_tail()(_keys)))})})())))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_assocMergeKeys()(_hm1)(_hm2)((function(){var $m; return (function(){return $m || ($m = (_tail()(_keys)))})})())))})})())))})})());};};}));}})(), 3, "\\hm1 hm2 keys . if (null? keys) hm1\n  if (null? (assocGetPair (head keys) hm1) )\n    [(assocGetPair (head keys) hm2) | (assocMergeKeys hm1 hm2 (tail keys))]\n    assocMergeKeys hm1 hm2 (tail keys)");;
  _assocMerge = Parse.define('assocMerge', (function() {var f; return function _assocMerge(){return f || (f = (function(_hm1){return function(_hm2){return _assocMergeKeys()(_hm1)(_hm2)((function(){var $m; return (function(){return $m || ($m = (_assocKeys()(_hm2)))})})());};}));}})(), 2, "\\hm1 hm2 . assocMergeKeys hm1 hm2 (assocKeys hm2)");;
  _assocSet = Parse.define('assocSet', (function() {var f; return function _assocSet(){return f || (f = (function(_k){return function(_v){return function(_anAssoc){return _cons()((function(){var $m; return (function(){return $m || ($m = (_cons()(_k)(_v)))})})())((function(){var $m; return (function(){return $m || ($m = (_assocRemove()(_k)(_anAssoc)))})})());};};}));}})(), 3, "\\k v anAssoc . [(cons k v) | (assocRemove k anAssoc)]");;
  _assocGet = Parse.define('assocGet', (function() {var f; return function _assocGet(){return f || (f = (function(_k){return function(_anAssoc){return _assocGetPair()(_k)(_anAssoc)((function(){var $m; return (function(){return $m || ($m = (function(_h){return function(_t){return function(_D){return _some()(_h);};};}))})})())(_none);};}));}})(), 2, "\\k anAssoc . (assocGetPair k anAssoc) (\\h t D . some h) none");;
  _assocGetWithDefault = Parse.define('assocGetWithDefault', (function() {var f; return function _assocGetWithDefault(){return f || (f = (function(_k){return function(_default){return function(_anAssoc){return _assocGetPair()(_k)(_anAssoc)((function(){var $m; return (function(){return $m || ($m = (function(_h){return function(_t){return function(_D){return _t();};};}))})})())(_default);};};}));}})(), 3, "\\k default anAssoc . (assocGetPair k anAssoc) (\\h t D . t) default");;
  _assocRemove = Parse.define('assocRemove', (function() {var f; return function _assocRemove(){return f || (f = (function(_k){return function(_anAssoc){return _removeIf()((function(){var $m; return (function(){return $m || ($m = (function(_x){return _eq()((function(){var $m; return (function(){return $m || ($m = (_assocKey()(_x)))})})())(_k);}))})})())(_anAssoc);};}));}})(), 2, "\\k anAssoc . removeIf (\\x . eq (assocKey x) k) anAssoc");;
  _html = Parse.define('html', (function() {var f; return function _html(){return f || (f = (Parse.setDataType(function(_x){return Parse.setType(function(_f){return _f()(_x);}, 'html');}, 'html')));}})(), 1, "\\x . \\f . f x");;
  _or$r = Parse.defineMacro('or[', (function() {var f; return function _or$r(){return f || (f = (function(_list){return _primOrVar()(_list)((function(){var $m; return (function(){return $m || ($m = (_dropLast()((function(){return 1}))((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})())))})})());}));}})(), 1, "\\list . primOrVar list (dropLast 1 (tail list))");;
  _primOrVar = Parse.define('primOrVar', (function() {var f; return function _primOrVar(){return f || (f = (function(_list){return function(_args){return _eq()(_args)(_nil)((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){return "true"}))(_nil)))})})())((function(){var $m; return (function(){return $m || ($m = (_eq()((function(){var $m; return (function(){return $m || ($m = (_tail()(_args)))})})())(_nil)(_args)((function(){var $m; return (function(){return $m || ($m = (_foldr1()((function(){var $m; return (function(){return $m || ($m = (function(_v){return function(_el){return _cons()((function(){return "or"}))((function(){var $m; return (function(){return $m || ($m = (_cons()(_v)((function(){var $m; return (function(){return $m || ($m = (_cons()(_el)(_nil)))})})())))})})());};}))})})())(_args)))})})())))})})());};}));}})(), 2, "\\list args . eq args nil\n  ['true']\n  eq (tail args) nil\n    args\n    foldr1 (\\v el . ['or' v el]) args");;
  _and$r = Parse.defineMacro('and[', (function() {var f; return function _and$r(){return f || (f = (function(_list){return _primAndVar()(_list)((function(){var $m; return (function(){return $m || ($m = (_dropLast()((function(){return 1}))((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})())))})})());}));}})(), 1, "\\list . primAndVar list (dropLast 1 (tail list))");;
  _primAndVar = Parse.define('primAndVar', (function() {var f; return function _primAndVar(){return f || (f = (function(_list){return function(_args){return _eq()(_args)(_nil)((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){return "false"}))(_nil)))})})())((function(){var $m; return (function(){return $m || ($m = (_eq()((function(){var $m; return (function(){return $m || ($m = (_tail()(_args)))})})())(_nil)(_args)((function(){var $m; return (function(){return $m || ($m = (_foldr1()((function(){var $m; return (function(){return $m || ($m = (function(_v){return function(_el){return _cons()((function(){return "and"}))((function(){var $m; return (function(){return $m || ($m = (_cons()(_v)((function(){var $m; return (function(){return $m || ($m = (_cons()(_el)(_nil)))})})())))})})());};}))})})())(_args)))})})())))})})());};}));}})(), 2, "\\list args . eq args nil\n  ['false']\n  eq (tail args) nil\n    args\n    foldr1 (\\v el . ['and' v el]) args");;
  _defInfixToken = Parse.define('defInfixToken', (function() {var f; return function _defInfixToken(){return f || (f = (function(_tokenName){return function(_location){return function(_reference){return _bind()((function(){var $m; return (function(){return $m || ($m = (_defToken()(_tokenName)))})})())((function(){var $m; return (function(){return $m || ($m = (function(__){return _bind()(_getParseFilterInfo)((function(){var $m; return (function(){return $m || ($m = (function(_defs){return function(_operators){return function(_operators){return _setParseFilterInfo()((function(){var $m; return (function(){return $m || ($m = (_assocSet()((function(){return "infix"}))(_operators)(_defs)))})})());}((function(){var $m; return (function(){return $m || ($m = (_eq()(_reference)(_nil)((function(){var $m; return (function(){return $m || ($m = (_eq()(_location)((function(){return "before"}))((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){var $m; return (function(){return $m || ($m = (_cons()(_tokenName)(_nil)))})})())(_operators)))})})())((function(){var $m; return (function(){return $m || ($m = (_append()(_operators)((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){var $m; return (function(){return $m || ($m = (_cons()(_tokenName)(_nil)))})})())(_nil)))})})())))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_insertOperator()(_tokenName)(_location)(_reference)(_operators)))})})())))})})());}((function(){var $m; return (function(){return $m || ($m = (_assocGetWithDefault()((function(){return "infix"}))(_nil)(_defs)))})})());}))})})());}))})})());};};}));}})(), 3, "\\tokenName location reference . do\n  defToken tokenName\n  defs <- getParseFilterInfo\n  operators = assocGetWithDefault 'infix' nil defs\n  operators = eq reference nil\n    eq location 'before'\n      [[tokenName] | operators]\n      append operators [[tokenName]]\n    insertOperator tokenName location reference operators\n  setParseFilterInfo (assocSet 'infix' operators defs)");;
  _insertOperator = Parse.define('insertOperator', (function() {var f; return function _insertOperator(){return f || (f = (function(_tokenName){return function(_location){return function(_reference){return function(_operators){return _any()((function(){var $m; return (function(){return $m || ($m = (_eq()(_reference)))})})())((function(){var $m; return (function(){return $m || ($m = (_head()(_operators)))})})())((function(){var $m; return (function(){return $m || ($m = (_eq()(_location)((function(){return "before"}))((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){var $m; return (function(){return $m || ($m = (_cons()(_tokenName)(_nil)))})})())(_operators)))})})())((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){var $m; return (function(){return $m || ($m = (_cons()(_tokenName)((function(){var $m; return (function(){return $m || ($m = (_head()(_operators)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_tail()(_operators)))})})())))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){var $m; return (function(){return $m || ($m = (_head()(_operators)))})})())((function(){var $m; return (function(){return $m || ($m = (_insertOperator()(_tokenName)(_location)(_reference)((function(){var $m; return (function(){return $m || ($m = (_tail()(_operators)))})})())))})})())))})})());};};};}));}})(), 4, "\\tokenName location reference operators . any (eq reference) (head operators)\n  eq location 'before'\n    [[tokenName] | operators]\n    [[tokenName | (head operators)] | (tail operators)]\n  [(head operators) | (insertOperator tokenName location reference (tail operators))]");;
  _insertOperator = Leisure.makeDispatchFunction('insertOperator', '_insertOperator', '_operators', ['_insertOperator', '_tokenName', '_location', '_reference', '_operators']);
Leisure.createMethod('nil', 'insertOperator', "\\tokenName location reference operators      . [[tokenName]]", function(_tokenName, _location, _reference, _operators) {return _cons()((function(){var $m; return (function(){return $m || ($m = (_cons()(_tokenName)(_nil)))})})())(_nil);});
  _testInfix = Parse.define('testInfix', (function() {var f; return function _testInfix(){return f || (f = (function(_str){return _bind()((function(){var $m; return (function(){return $m || ($m = (_getValueOr()((function(){return "parseFilter.defs"}))(_nil)))})})())((function(){var $m; return (function(){return $m || ($m = (function(_defs){return _bind()((function(){var $m; return (function(){return $m || ($m = (_print()((function(){var $m; return (function(){return $m || ($m = (_concat()((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){return "defs: "}))((function(){var $m; return (function(){return $m || ($m = (_cons()(_defs)(_nil)))})})())))})})())))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (function(__){return _print()((function(){var $m; return (function(){return $m || ($m = (_mainParseInfix()(_defs)((function(){var $m; return (function(){return $m || ($m = (_scan()(_str)(_id)(_id)))})})())))})})());}))})})());}))})})());}));}})(), 1, "\\str . do\n  defs <- getValueOr 'parseFilter.defs' nil\n  print concat['defs: ' defs]\n  print (mainParseInfix defs (scan str id id))");;
  _mainParseInfix = Parse.define('mainParseInfix', (function() {var f; return function _mainParseInfix(){return f || (f = (function(_parseDefs){return function(_list){return _parseInfix()((function(){var $m; return (function(){return $m || ($m = (_assocGetWithDefault()((function(){return "infix"}))(_nil)(_parseDefs)))})})())(_list);};}));}})(), 2, "\\parseDefs list . parseInfix (assocGetWithDefault 'infix' nil parseDefs) list");;
  _parseInfix = Parse.define('parseInfix', (function() {var f; return function _parseInfix(){return f || (f = (function(_tokens){return function(_list){return _list();};}));}})(), 2, "\\tokens list . list");;
  _parseInfix = Leisure.makeDispatchFunction('parseInfix', '_parseInfix', '_list', ['_parseInfix', '_tokens', '_list']);
Leisure.createMethod('cons', 'parseInfix', "\\tokens list       . callParseInfixList tokens list", function(_tokens, _list) {return _callParseInfixList()(_tokens)(_list);});
  _parseInfix = Leisure.makeDispatchFunction('parseInfix', '_parseInfix', '_list', ['_parseInfix', '_tokens', '_list']);
Leisure.createMethod('lexCons', 'parseInfix', "\\tokens list          . callParseInfixList tokens list", function(_tokens, _list) {return _callParseInfixList()(_tokens)(_list);});
  _callParseInfixList = Parse.define('callParseInfixList', (function() {var f; return function _callParseInfixList(){return f || (f = (function(_tokens){return function(_list){return function(_prep){return _parseInfixList()(_tokens)(_dlempty)((function(){var $m; return (function(){return $m || ($m = (_head()(_prep)))})})())((function(){var $m; return (function(){return $m || ($m = (_tail()(_prep)))})})());}((function(){var $m; return (function(){return $m || ($m = (_collapseInnerTokens()(_tokens)((function(){var $m; return (function(){return $m || ($m = (_collapseFirstTokens()(_tokens)((function(){var $m; return (function(){return $m || ($m = (_map()((function(){var $m; return (function(){return $m || ($m = (_parseInfix()(_tokens)))})})())(_list)))})})())))})})())))})})());};}));}})(), 2, "\\tokens list . do\n  prep = collapseInnerTokens tokens (collapseFirstTokens tokens (map (parseInfix tokens) list))\n  parseInfixList tokens dlempty (head prep) (tail prep)");;
  _collapseInnerTokens = Parse.define('collapseInnerTokens', (function() {var f; return function _collapseInnerTokens(){return f || (f = (function(_tokens){return function(_list){return _list();};}));}})(), 2, "\\tokens list . list");;
  _collapseInnerTokens = Leisure.makeDispatchFunction('collapseInnerTokens', '_collapseInnerTokens', '_list', ['_collapseInnerTokens', '_tokens', '_list']);
Leisure.createMethod('cons', 'collapseInnerTokens', "\\tokens list       . collapseInner1 tokens (head list) (tail list) list", function(_tokens, _list) {return _collapseInner1()(_tokens)((function(){var $m; return (function(){return $m || ($m = (_head()(_list)))})})())((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})())(_list);});
  _collapseInner1 = Parse.define('collapseInner1', (function() {var f; return function _collapseInner1(){return f || (f = (function(_tokens){return function(_op){return function(_rest){return function(_orig){return _orig();};};};}));}})(), 4, "\\tokens op rest orig . orig");;
  _collapseInner1 = Leisure.makeDispatchFunction('collapseInner1', '_collapseInner1', '_rest', ['_collapseInner1', '_tokens', '_op', '_rest', '_orig']);
Leisure.createMethod('cons', 'collapseInner1', "\\tokens op rest       orig . collapseInner2 tokens op (head rest) (tail rest)", function(_tokens, _op, _rest, _orig) {return _collapseInner2()(_tokens)(_op)((function(){var $m; return (function(){return $m || ($m = (_head()(_rest)))})})())((function(){var $m; return (function(){return $m || ($m = (_tail()(_rest)))})})());});
  _collapseInner2 = Parse.define('collapseInner2', (function() {var f; return function _collapseInner2(){return f || (f = (function(_tokens){return function(_op){return function(_2nd){return function(_rest){return _cons()(_op)((function(){var $m; return (function(){return $m || ($m = (_cons()(_2nd)(_rest)))})})());};};};}));}})(), 4, "\\tokens op 2nd rest . [op 2nd | rest]");;
  _collapseInner2 = Leisure.makeDispatchFunction('collapseInner2', '_collapseInner2', '_rest', ['_collapseInner2', '_tokens', '_op', '_2nd', '_rest']);
Leisure.createMethod('cons', 'collapseInner2', "\\tokens op 2nd rest       . collapseInner3 tokens op 2nd (head rest) (tail rest)", function(_tokens, _op, _2nd, _rest) {return _collapseInner3()(_tokens)(_op)(_2nd)((function(){var $m; return (function(){return $m || ($m = (_head()(_rest)))})})())((function(){var $m; return (function(){return $m || ($m = (_tail()(_rest)))})})());});
  _collapseInner3 = Parse.define('collapseInner3', (function() {var f; return function _collapseInner3(){return f || (f = (function(_tokens){return function(_op){return function(_2nd){return function(_3rd){return function(_rest){return _cons()(_op)((function(){var $m; return (function(){return $m || ($m = (_collapseInner2()(_tokens)(_2nd)(_3rd)(_rest)))})})());};};};};}));}})(), 5, "\\tokens op 2nd 3rd rest . [op | (collapseInner2 tokens 2nd 3rd rest)]");;
  _collapseInner3 = Leisure.makeDispatchFunction('collapseInner3', '_collapseInner3', '_op', ['_collapseInner3', '_tokens', '_op', '_2nd', '_3rd', '_rest']);
Leisure.createMethod('token', 'collapseInner3', "\\tokens op        2nd 3rd rest . collapseInner4 tokens op 2nd 3rd rest", function(_tokens, _op, _2nd, _3rd, _rest) {return _collapseInner4()(_tokens)(_op)(_2nd)(_3rd)(_rest);});
  _collapseInner4 = Parse.define('collapseInner4', (function() {var f; return function _collapseInner4(){return f || (f = (function(_tokens){return function(_op){return function(_2nd){return function(_3rd){return function(_rest){return _cons()(_op)((function(){var $m; return (function(){return $m || ($m = (_collapseInner2()(_tokens)(_2nd)(_3rd)(_rest)))})})());};};};};}));}})(), 5, "\\tokens op 2nd 3rd rest . [op | (collapseInner2 tokens 2nd 3rd rest)]");;
  _collapseInner4 = Leisure.makeDispatchFunction('collapseInner4', '_collapseInner4', '_2nd', ['_collapseInner4', '_tokens', '_op', '_2nd', '_3rd', '_rest']);
Leisure.createMethod('token', 'collapseInner4', "\\tokens op 2nd        3rd rest . collapseInner5 tokens op 2nd 3rd rest", function(_tokens, _op, _2nd, _3rd, _rest) {return _collapseInner5()(_tokens)(_op)(_2nd)(_3rd)(_rest);});
  _collapseInner5 = Parse.define('collapseInner5', (function() {var f; return function _collapseInner5(){return f || (f = (function(_tokens){return function(_op){return function(_2nd){return function(_3rd){return function(_rest){return _cons()(_op)((function(){var $m; return (function(){return $m || ($m = (_collapseInner2()(_tokens)(_2nd)(_3rd)(_rest)))})})());};};};};}));}})(), 5, "\\tokens op 2nd 3rd rest . [op | (collapseInner2 tokens 2nd 3rd rest)]");;
  _collapseInner5 = Leisure.makeDispatchFunction('collapseInner5', '_collapseInner5', '_3rd', ['_collapseInner5', '_tokens', '_op', '_2nd', '_3rd', '_rest']);
Leisure.createMethod('token', 'collapseInner5', "\\tokens op 2nd 3rd        rest . and\n  isOperator tokens op\n  and\n    isOperator tokens 2nd\n    adjacent 2nd 3rd\n  [op (collapseTokens 2nd 3rd) | (collapseInnerTokens tokens rest)]\n  [op | (collapseInner2 tokens 2nd 3rd rest)]", function(_tokens, _op, _2nd, _3rd, _rest) {return _and()((function(){var $m; return (function(){return $m || ($m = (_isOperator()(_tokens)(_op)))})})())((function(){var $m; return (function(){return $m || ($m = (_and()((function(){var $m; return (function(){return $m || ($m = (_isOperator()(_tokens)(_2nd)))})})())((function(){var $m; return (function(){return $m || ($m = (_adjacent()(_2nd)(_3rd)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_cons()(_op)((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){var $m; return (function(){return $m || ($m = (_collapseTokens()(_2nd)(_3rd)))})})())((function(){var $m; return (function(){return $m || ($m = (_collapseInnerTokens()(_tokens)(_rest)))})})())))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_cons()(_op)((function(){var $m; return (function(){return $m || ($m = (_collapseInner2()(_tokens)(_2nd)(_3rd)(_rest)))})})())))})})());});
  _isOperator = Parse.define('isOperator', (function() {var f; return function _isOperator(){return f || (f = (function(_tokens){return function(_tok){return _$y()((function(){var $m; return (function(){return $m || ($m = (_getPrecedence()((function(){return 0}))(_tok)(_tokens)))})})())((function(){var $m; return (function(){return $m || ($m = (_length()(_tokens)))})})());};}));}})(), 2, "\\tokens tok . < (getPrecedence 0 tok tokens) (length tokens)");;
  _collapseFirstTokens = Parse.define('collapseFirstTokens', (function() {var f; return function _collapseFirstTokens(){return f || (f = (function(_tokens){return function(_list){return _list();};}));}})(), 2, "\\tokens list . list");;
  _collapseFirstTokens = Leisure.makeDispatchFunction('collapseFirstTokens', '_collapseFirstTokens', '_list', ['_collapseFirstTokens', '_tokens', '_list']);
Leisure.createMethod('cons', 'collapseFirstTokens', "\\tokens list       . null? (tail list)\n  list\n  collapseFirstTokens1 tokens (head list) (head (tail list)) (tail (tail list))\n    id\n    list", function(_tokens, _list) {return _null$e()((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})())(_list)((function(){var $m; return (function(){return $m || ($m = (_collapseFirstTokens1()(_tokens)((function(){var $m; return (function(){return $m || ($m = (_head()(_list)))})})())((function(){var $m; return (function(){return $m || ($m = (_head()((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_tail()((function(){var $m; return (function(){return $m || ($m = (_tail()(_list)))})})())))})})())(_id)(_list)))})})());});
  _collapseFirstTokens1 = Parse.define('collapseFirstTokens1', (function() {var f; return function _collapseFirstTokens1(){return f || (f = (function(_tokens){return function(_op){return function(_next){return function(_rest){return _none();};};};}));}})(), 4, "\\tokens op next rest . none");;
  _collapseFirstTokens1 = Leisure.makeDispatchFunction('collapseFirstTokens1', '_collapseFirstTokens1', '_op', ['_collapseFirstTokens1', '_tokens', '_op', '_next', '_rest']);
Leisure.createMethod('token', 'collapseFirstTokens1', "\\tokens op        next rest . isOperator tokens op\n  collapseFirstTokens2 tokens op next rest\n  none", function(_tokens, _op, _next, _rest) {return _isOperator()(_tokens)(_op)((function(){var $m; return (function(){return $m || ($m = (_collapseFirstTokens2()(_tokens)(_op)(_next)(_rest)))})})())(_none);});
  _collapseFirstTokens2 = Parse.define('collapseFirstTokens2', (function() {var f; return function _collapseFirstTokens2(){return f || (f = (function(_tokens){return function(_op){return function(_next){return function(_rest){return _none();};};};}));}})(), 4, "\\tokens op next rest . none");;
  _collapseFirstTokens2 = Leisure.makeDispatchFunction('collapseFirstTokens2', '_collapseFirstTokens2', '_next', ['_collapseFirstTokens2', '_tokens', '_op', '_next', '_rest']);
Leisure.createMethod('token', 'collapseFirstTokens2', "\\tokens op next        rest . adjacent op next\n  some [(collapseTokens op next) | rest]\n  none", function(_tokens, _op, _next, _rest) {return _adjacent()(_op)(_next)((function(){var $m; return (function(){return $m || ($m = (_some()((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){var $m; return (function(){return $m || ($m = (_collapseTokens()(_op)(_next)))})})())(_rest)))})})())))})})())(_none);});
  _adjacent = Parse.define('adjacent', (function() {var f; return function _adjacent(){return f || (f = (function(_tok1){return function(_tok2){return _eq()((function(){var $m; return (function(){return $m || ($m = (_$o()((function(){var $m; return (function(){return $m || ($m = (_tokenStart()(_tok1)))})})())((function(){var $m; return (function(){return $m || ($m = (_strlen()((function(){var $m; return (function(){return $m || ($m = (_tokenName()(_tok1)))})})())))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_tokenStart()(_tok2)))})})());};}));}})(), 2, "\\tok1 tok2 . eq (+ (tokenStart tok1) (strlen (tokenName tok1))) (tokenStart tok2)");;
  _collapseTokens = Parse.define('collapseTokens', (function() {var f; return function _collapseTokens(){return f || (f = (function(_tok1){return function(_tok2){return _token()((function(){var $m; return (function(){return $m || ($m = (_concat()((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){var $m; return (function(){return $m || ($m = (_tokenName()(_tok1)))})})())((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){var $m; return (function(){return $m || ($m = (_tokenName()(_tok2)))})})())(_nil)))})})())))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_tokenStart()(_tok1)))})})());};}));}})(), 2, "\\tok1 tok2 . token concat[(tokenName tok1) (tokenName tok2)] (tokenStart tok1)");;
  _printOperators = Parse.define('printOperators', (function _printOperators() {return ((_bind()(_getParseFilterInfo)((function(){var $m; return (function(){return $m || ($m = (function(_defs){return _print()((function(){var $m; return (function(){return $m || ($m = (_assocGetWithDefault()((function(){return "infix"}))(_nil)(_defs)))})})());}))})})())));}), 0, "do\n  defs <- getParseFilterInfo\n  print (assocGetWithDefault 'infix' nil defs)");;
  _parseInfixList = Parse.define('parseInfixList', (function() {var f; return function _parseInfixList(){return f || (f = (function(_tokens){return function(_firstList){return function(_token){return function(_restList){return function(_fullList){return function(_op){return function(_nextTok){return function(_nextRest){return function(_prec){return function(_nextPrec){return function(_nextParsed){return _null$e()(_tokens)(_fullList)((function(){var $m; return (function(){return $m || ($m = (_null$e()(_restList)((function(){var $m; return (function(){return $m || ($m = (_parseInfixList()((function(){var $m; return (function(){return $m || ($m = (_tail()(_tokens)))})})())(_dlempty)((function(){var $m; return (function(){return $m || ($m = (_head()(_fullList)))})})())((function(){var $m; return (function(){return $m || ($m = (_tail()(_fullList)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_eq()(_prec)((function(){var $m; return (function(){return $m || ($m = (_length()(_tokens)))})})())((function(){var $m; return (function(){return $m || ($m = (_parseInfixList()(_tokens)((function(){var $m; return (function(){return $m || ($m = (_dlPush()(_firstList)(_token)))})})())(_op)((function(){var $m; return (function(){return $m || ($m = (_tail()(_restList)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_null$e()((function(){var $m; return (function(){return $m || ($m = (_tail()(_restList)))})})())((function(){var $m; return (function(){return $m || ($m = (_error()((function(){var $m; return (function(){return $m || ($m = (_concat()((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){return "Parse error -- expected token after operator: "}))((function(){var $m; return (function(){return $m || ($m = (_cons()(_op)(_nil)))})})())))})})())))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_$y()(_prec)(_nextPrec)((function(){var $m; return (function(){return $m || ($m = (_parseInfixList()(_tokens)(_firstList)((function(){var $m; return (function(){return $m || ($m = (_cons()(_op)((function(){var $m; return (function(){return $m || ($m = (_cons()(_token)((function(){var $m; return (function(){return $m || ($m = (_cons()(_nextTok)(_nil)))})})())))})})())))})})())(_nextRest)))})})())((function(){var $m; return (function(){return $m || ($m = (_parseInfixList()(_tokens)(_firstList)((function(){var $m; return (function(){return $m || ($m = (_cons()(_op)((function(){var $m; return (function(){return $m || ($m = (_cons()(_token)((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){var $m; return (function(){return $m || ($m = (_head()(_nextParsed)))})})())(_nil)))})})())))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_tail()(_nextParsed)))})})())))})})())))})})())))})})())))})})())))})})());}((function(){var $m; return (function(){return $m || ($m = (_parseInfixList()(_tokens)(_dlempty)(_nextTok)(_nextRest)))})})());}((function(){var $m; return (function(){return $m || ($m = (_or()((function(){var $m; return (function(){return $m || ($m = (_null$e()(_restList)))})})())((function(){var $m; return (function(){return $m || ($m = (_or()((function(){var $m; return (function(){return $m || ($m = (_null$e()((function(){var $m; return (function(){return $m || ($m = (_tail()(_restList)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_null$e()(_nextRest)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_length()(_tokens)))})})())((function(){var $m; return (function(){return $m || ($m = (_getPrecedence()((function(){return 0}))((function(){var $m; return (function(){return $m || ($m = (_head()(_nextRest)))})})())(_tokens)))})})())))})})());}((function(){var $m; return (function(){return $m || ($m = (_getPrecedence()((function(){return 0}))(_op)(_tokens)))})})());}((function(){var $m; return (function(){return $m || ($m = (_tail()((function(){var $m; return (function(){return $m || ($m = (_tail()(_restList)))})})())))})})());}((function(){var $m; return (function(){return $m || ($m = (_head()((function(){var $m; return (function(){return $m || ($m = (_tail()(_restList)))})})())))})})());}((function(){var $m; return (function(){return $m || ($m = (_head()(_restList)))})})());}((function(){var $m; return (function(){return $m || ($m = (_firstList()((function(){var $m; return (function(){return $m || ($m = (_cons()(_token)(_restList)))})})())))})})());};};};}));}})(), 4, "\\tokens firstList token restList . do\n  fullList = firstList [token | restList]\n  op = head restList\n  nextTok = head (tail restList)\n  nextRest = tail (tail restList)\n  prec = getPrecedence 0 op tokens\n  nextPrec = or (null? restList) (or (null? (tail restList)) (null? nextRest))\n    length tokens\n    getPrecedence 0 (head nextRest) tokens\n  nextParsed = parseInfixList tokens dlempty nextTok nextRest\n  null? tokens\n    fullList\n    null? restList\n      parseInfixList (tail tokens) dlempty (head fullList) (tail fullList)\n      eq prec (length tokens)\n        parseInfixList tokens (dlPush firstList token) op (tail restList)\n        null? (tail restList)\n          error concat['Parse error -- expected token after operator: ' op]\n          < prec nextPrec\n            parseInfixList tokens firstList [op token nextTok] nextRest\n            parseInfixList tokens firstList [op token (head nextParsed)] (tail nextParsed)");;
  _getPrecedence = Parse.define('getPrecedence', (function() {var f; return function _getPrecedence(){return f || (f = (function(_index){return function(_op){return function(_tokens){return _any()((function(){var $m; return (function(){return $m || ($m = (_eq()((function(){var $m; return (function(){return $m || ($m = (_tokString()(_op)))})})())))})})())((function(){var $m; return (function(){return $m || ($m = (_head()(_tokens)))})})())(_index)((function(){var $m; return (function(){return $m || ($m = (_getPrecedence()((function(){var $m; return (function(){return $m || ($m = (_$o()((function(){return 1}))(_index)))})})())(_op)((function(){var $m; return (function(){return $m || ($m = (_tail()(_tokens)))})})())))})})());};};}));}})(), 3, "\\index op tokens . any (eq (tokString op)) (head tokens)\n  index\n  getPrecedence (+ 1 index) op (tail tokens)");;
  _getPrecedence = Leisure.makeDispatchFunction('getPrecedence', '_getPrecedence', '_tokens', ['_getPrecedence', '_index', '_op', '_tokens']);
Leisure.createMethod('nil', 'getPrecedence', "\\index op tokens      . index", function(_index, _op, _tokens) {return _index();});
  _operatorIn = Parse.define('operatorIn', (function() {var f; return function _operatorIn(){return f || (f = (function(_op){return function(_tokens){return function(_opEq){return _any()((function(){var $m; return (function(){return $m || ($m = (function(_toks){return _any()(_opEq)(_toks);}))})})())(_tokens);}((function(){var $m; return (function(){return $m || ($m = (_eq()((function(){var $m; return (function(){return $m || ($m = (_tokString()(_op)))})})())))})})());};}));}})(), 2, "\\op tokens . do\n  opEq = eq (tokString op)\n  any (\\toks . any opEq toks) tokens");;
  _matchIndex = Parse.define('matchIndex', (function() {var f; return function _matchIndex(){return f || (f = (function(_match){return _head()((function(){var $m; return (function(){return $m || ($m = (_tail()(_match)))})})());}));}})(), 1, "\\match .head (tail match)");;
  _matchInput = Parse.define('matchInput', (function() {var f; return function _matchInput(){return f || (f = (function(_match){return _head()((function(){var $m; return (function(){return $m || ($m = (_tail()((function(){var $m; return (function(){return $m || ($m = (_tail()(_match)))})})())))})})());}));}})(), 1, "\\match .head (tail (tail match))");;
  _matchMatched = Parse.define('matchMatched', (function() {var f; return function _matchMatched(){return f || (f = (function(_match){return _head()((function(){var $m; return (function(){return $m || ($m = (_head()(_match)))})})());}));}})(), 1, "\\match .head (head match)");;
  _matchGroups = Parse.define('matchGroups', (function() {var f; return function _matchGroups(){return f || (f = (function(_match){return _tail()((function(){var $m; return (function(){return $m || ($m = (_head()(_match)))})})());}));}})(), 1, "\\match .tail (head match)");;
})
.andThen(function(){ return   (function(_x){return _bind()((function(){var $m; return (function(){return $m || ($m = (_defInfixToken()((function(){return "*"}))((function(){return "before"}))(_nil)))})})())((function(){var $m; return (function(){return $m || ($m = (function(__){return _bind()((function(){var $m; return (function(){return $m || ($m = (_defInfixToken()((function(){return "/"}))((function(){return "at"}))((function(){return "*"}))))})})())((function(){var $m; return (function(){return $m || ($m = (function(__){return _bind()((function(){var $m; return (function(){return $m || ($m = (_defInfixToken()((function(){return "+"}))((function(){return "at"}))(_nil)))})})())((function(){var $m; return (function(){return $m || ($m = (function(__){return _bind()((function(){var $m; return (function(){return $m || ($m = (_defInfixToken()((function(){return "-"}))((function(){return "at"}))((function(){return "+"}))))})})())((function(){var $m; return (function(){return $m || ($m = (function(__){return _bind()((function(){var $m; return (function(){return $m || ($m = (_defInfixToken()((function(){return "<"}))((function(){return "at"}))(_nil)))})})())((function(){var $m; return (function(){return $m || ($m = (function(__){return _bind()((function(){var $m; return (function(){return $m || ($m = (_defInfixToken()((function(){return ">"}))((function(){return "at"}))(_nil)))})})())((function(){var $m; return (function(){return $m || ($m = (function(__){return function(_x){return _bind()((function(){var $m; return (function(){return $m || ($m = (_addParseFilter()(_mainParseInfix)))})})())((function(){var $m; return (function(){return $m || ($m = (function(__){return _bind()((function(){var $m; return (function(){return $m || ($m = (_forward()((function(){return "getURI"}))))})})())((function(){var $m; return (function(){return $m || ($m = (function(__){return _bind()((function(){var $m; return (function(){return $m || ($m = (_forward()((function(){return "setURI"}))))})})())((function(){var $m; return (function(){return $m || ($m = (function(__){return _bind()((function(){var $m; return (function(){return $m || ($m = (_forward()((function(){return "getDocument"}))))})})())((function(){var $m; return (function(){return $m || ($m = (function(__){return _forward()((function(){return "replaceDocument"}));}))})})());}))})})());}))})})());}))})})());}((function(){var $m; return (function(){return $m || ($m = (_log()((function(){return 2}))((function(){return "filter"}))))})})());}))})})());}))})})());}))})})());}))})})());}))})})());}))})})());}((function(){var $m; return (function(){return $m || ($m = (_log()((function(){return 1}))((function(){return "infix"}))))})})()))})
.andThen(function(){
  _save = Parse.define('save', (function _save() {return ((_bind()(_getURI)((function(){var $m; return (function(){return $m || ($m = (function(_uri){return _bind()(_getDocument)((function(){var $m; return (function(){return $m || ($m = (function(_doc){return _write()(_uri)(_doc);}))})})());}))})})())));}), 0, "do\n  uri <- getURI\n  doc <- getDocument\n  write uri doc");;
  _saveAs = Parse.define('saveAs', (function() {var f; return function _saveAs(){return f || (f = (function(_newUri){return _bind()(_getDocument)((function(){var $m; return (function(){return $m || ($m = (function(_doc){return _write()(_newUri)(_doc);}))})})());}));}})(), 1, "\\newUri . do\n  doc <- getDocument\n  write newUri doc");;
  _open = Parse.define('open', (function() {var f; return function _open(){return f || (f = (function(_uri){return _bind()((function(){var $m; return (function(){return $m || ($m = (_read()(_uri)))})})())((function(){var $m; return (function(){return $m || ($m = (function(_contents$e){return _contents$e()((function(){var $m; return (function(){return $m || ($m = (function(_data){return _bind()((function(){var $m; return (function(){return $m || ($m = (_setURI()(_uri)))})})())((function(){var $m; return (function(){return $m || ($m = (function(__){return _replaceDocument()(_data);}))})})());}))})})())((function(){var $m; return (function(){return $m || ($m = (function(_err){return _print()((function(){var $m; return (function(){return $m || ($m = (_concat()((function(){var $m; return (function(){return $m || ($m = (_cons()((function(){return "Error: "}))((function(){var $m; return (function(){return $m || ($m = (_cons()(_err)(_nil)))})})())))})})())))})})());}))})})());}))})})());}));}})(), 1, "\\uri . do\n  contents? <- read uri\n  contents?\n    \\data. do\n      setURI uri\n      replaceDocument data\n    \\err . print concat['Error: ' err]");;

});
if (typeof window != 'undefined') Prim.runMonad(module.exports, Prim.defaultEnv, function(){});
}).call(this)