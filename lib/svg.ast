[
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"assocGetWithDefault"}},"arg":{"_type":"lit","value":3}},"arg":{"_type":"lit","value":"assocGetWithDefault key defaultValue map = assoc key map id defaultValue"}},"arg":{"_type":"lambda","varName":"key","body":{"_type":"lambda","varName":"defaultValue","body":{"_type":"lambda","varName":"map","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"assoc"},"arg":{"_type":"ref","varName":"key"}},"arg":{"_type":"ref","varName":"map"}},"arg":{"_type":"ref","varName":"id"}},"arg":{"_type":"ref","varName":"defaultValue"}}}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"insertFields"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"insertFields map = (isNil map) ''\n  concat[(field (head map)) (insertFields (tail map))]"}},"arg":{"_type":"lambda","varName":"map","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"isNil"},"arg":{"_type":"ref","varName":"map"}},"arg":{"_type":"lit","value":""}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"field"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"head"},"arg":{"_type":"ref","varName":"map"}}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"insertFields"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"tail"},"arg":{"_type":"ref","varName":"map"}}}},"arg":{"_type":"ref","varName":"nil"}}}}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"svgTemplate"}},"arg":{"_type":"lit","value":2}},"arg":{"_type":"lit","value":"svgTemplate attrs contents = html concat['<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" ' attrs '>' contents '</svg>']"}},"arg":{"_type":"lambda","varName":"attrs","body":{"_type":"lambda","varName":"contents","body":{"_type":"apply","func":{"_type":"ref","varName":"html"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"attrs"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":">"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"contents"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"</svg>"}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"svg"}},"arg":{"_type":"lit","value":2}},"arg":{"_type":"lit","value":"svg o map = svgTemplate concat['style=\"width: ' (assocGetWithDefault 'width' 100 map) '; height: '  (assocGetWithDefault 'height' 100 map) '\"'] (o id)"}},"arg":{"_type":"lambda","varName":"o","body":{"_type":"lambda","varName":"map","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"svgTemplate"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"style=\"width: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"assocGetWithDefault"},"arg":{"_type":"lit","value":"width"}},"arg":{"_type":"lit","value":100}},"arg":{"_type":"ref","varName":"map"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"; height: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"assocGetWithDefault"},"arg":{"_type":"lit","value":"height"}},"arg":{"_type":"lit","value":100}},"arg":{"_type":"ref","varName":"map"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\""}},"arg":{"_type":"ref","varName":"nil"}}}}}}}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"o"},"arg":{"_type":"ref","varName":"id"}}}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"svgFile"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"svgFile map = html concat['<object xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" ' (insertFields map) '</object>']"}},"arg":{"_type":"lambda","varName":"map","body":{"_type":"apply","func":{"_type":"ref","varName":"html"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"<object xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"insertFields"},"arg":{"_type":"ref","varName":"map"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"</object>"}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"field"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"field cell = cell \\key value . concat[key '=\"' value '\" ']"}},"arg":{"_type":"lambda","varName":"cell","body":{"_type":"apply","func":{"_type":"ref","varName":"cell"},"arg":{"_type":"lambda","varName":"key","body":{"_type":"lambda","varName":"value","body":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"key"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"=\""}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"value"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\" "}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"defaultCircleMap"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"defaultCircleMap = ['cx':50 'cy':50 'r':40 'stroke':'black' 'stroke-width':2 'fill':'red']"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"cx"}},"arg":{"_type":"lit","value":50}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"cy"}},"arg":{"_type":"lit","value":50}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"r"}},"arg":{"_type":"lit","value":40}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"stroke"}},"arg":{"_type":"lit","value":"black"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"stroke-width"}},"arg":{"_type":"lit","value":2}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"fill"}},"arg":{"_type":"lit","value":"red"}}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"defaultRectMap"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"defaultRectMap = ['x':1 'y':1 'width':50 'height':50 'stroke':'black' 'stroke-width':2 'fill':'green']"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"x"}},"arg":{"_type":"lit","value":1}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"y"}},"arg":{"_type":"lit","value":1}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"width"}},"arg":{"_type":"lit","value":50}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"height"}},"arg":{"_type":"lit","value":50}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"stroke"}},"arg":{"_type":"lit","value":"black"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"stroke-width"}},"arg":{"_type":"lit","value":2}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"fill"}},"arg":{"_type":"lit","value":"green"}}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"defaultLineMap"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"defaultLineMap = ['x1':0 'y1':0 'x2':50 'y2':50 'stroke':'black' 'stroke-width':2]"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"x1"}},"arg":{"_type":"lit","value":0}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"y1"}},"arg":{"_type":"lit","value":0}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"x2"}},"arg":{"_type":"lit","value":50}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"y2"}},"arg":{"_type":"lit","value":50}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"stroke"}},"arg":{"_type":"lit","value":"black"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"stroke-width"}},"arg":{"_type":"lit","value":2}}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"defaultEllipseMap"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"defaultEllipseMap = ['cx':50 'cy':50 'rx':40 'ry':40 'stroke':'black' 'stroke-width':2 'fill':'blue']"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"cx"}},"arg":{"_type":"lit","value":50}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"cy"}},"arg":{"_type":"lit","value":50}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"rx"}},"arg":{"_type":"lit","value":40}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"ry"}},"arg":{"_type":"lit","value":40}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"stroke"}},"arg":{"_type":"lit","value":"black"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"stroke-width"}},"arg":{"_type":"lit","value":2}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"fill"}},"arg":{"_type":"lit","value":"blue"}}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"defaultTextMap"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"defaultTextMap = ['x':0 'y':10 'stroke':'black' 'stroke-width':2 'fill':'black']"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"x"}},"arg":{"_type":"lit","value":0}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"y"}},"arg":{"_type":"lit","value":10}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"stroke"}},"arg":{"_type":"lit","value":"black"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"stroke-width"}},"arg":{"_type":"lit","value":2}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"fill"}},"arg":{"_type":"lit","value":"black"}}},"arg":{"_type":"ref","varName":"nil"}}}}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"defaultPolygonMap"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"defaultPolygonMap = ['points':'350 75  379 161 469 161 397 215 423 301 350 250 277 301 303 215 231 161 321 161' 'stroke':'black' 'stroke-width':2 'fill':'yellow']"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"points"}},"arg":{"_type":"lit","value":"350 75  379 161 469 161 397 215 423 301 350 250 277 301 303 215 231 161 321 161"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"stroke"}},"arg":{"_type":"lit","value":"black"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"stroke-width"}},"arg":{"_type":"lit","value":2}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"fill"}},"arg":{"_type":"lit","value":"yellow"}}},"arg":{"_type":"ref","varName":"nil"}}}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"svgNode"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"svgNode contents = \\f . f contents"}},"arg":{"_type":"anno","name":"dataType","data":"svgNode","body":{"_type":"lambda","varName":"contents","body":{"_type":"anno","name":"type","data":"svgNode","body":{"_type":"lambda","varName":"f","body":{"_type":"apply","func":{"_type":"ref","varName":"f"},"arg":{"_type":"ref","varName":"contents"}}}}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"svgNodes"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"svgNodes nodeList = nodeList (\\h t D . cons (h id) (svgNodes t)) nil"}},"arg":{"_type":"lambda","varName":"nodeList","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"nodeList"},"arg":{"_type":"lambda","varName":"h","body":{"_type":"lambda","varName":"t","body":{"_type":"lambda","varName":"D","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"h"},"arg":{"_type":"ref","varName":"id"}}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"svgNodes"},"arg":{"_type":"ref","varName":"t"}}}}}}},"arg":{"_type":"ref","varName":"nil"}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"svgConcat"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"svgConcat nodeList = svgNode (strCat (svgNodes nodeList))"}},"arg":{"_type":"lambda","varName":"nodeList","body":{"_type":"apply","func":{"_type":"ref","varName":"svgNode"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"svgNodes"},"arg":{"_type":"ref","varName":"nodeList"}}}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"svgElement"}},"arg":{"_type":"lit","value":2}},"arg":{"_type":"lit","value":"svgElement name map = svgNode concat['<' name ' ' (insertFields map) '/>']"}},"arg":{"_type":"lambda","varName":"name","body":{"_type":"lambda","varName":"map","body":{"_type":"apply","func":{"_type":"ref","varName":"svgNode"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"<"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"name"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":" "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"insertFields"},"arg":{"_type":"ref","varName":"map"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"/>"}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"svgMeasure"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"svgMeasure content = primSvgMeasure content"}},"arg":{"_type":"lambda","varName":"content","body":{"_type":"apply","func":{"_type":"ref","varName":"primSvgMeasure"},"arg":{"_type":"ref","varName":"content"}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"svgPresent"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"svgPresent content = svgMeasure content \\x y w h .\n  svgTemplate concat[\"width='\" w \"' height='\" h \"' viewbox='\" x ' ' y ' ' w ' ' h \"'\"] content"}},"arg":{"_type":"lambda","varName":"content","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"svgMeasure"},"arg":{"_type":"ref","varName":"content"}},"arg":{"_type":"lambda","varName":"x","body":{"_type":"lambda","varName":"y","body":{"_type":"lambda","varName":"w","body":{"_type":"lambda","varName":"h","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"svgTemplate"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"width='"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"w"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"' height='"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"h"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"' viewbox='"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"x"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":" "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"y"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":" "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"w"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":" "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"h"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"'"}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}}}}}}}}},"arg":{"_type":"ref","varName":"content"}}}}}}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"circle"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"circle map = svgElement 'circle' ((isNil map) defaultCircleMap map)"}},"arg":{"_type":"lambda","varName":"map","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"svgElement"},"arg":{"_type":"lit","value":"circle"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"isNil"},"arg":{"_type":"ref","varName":"map"}},"arg":{"_type":"ref","varName":"defaultCircleMap"}},"arg":{"_type":"ref","varName":"map"}}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"rect"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"rect map = svgElement 'rect' ((isNil map) defaultRectMap map)"}},"arg":{"_type":"lambda","varName":"map","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"svgElement"},"arg":{"_type":"lit","value":"rect"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"isNil"},"arg":{"_type":"ref","varName":"map"}},"arg":{"_type":"ref","varName":"defaultRectMap"}},"arg":{"_type":"ref","varName":"map"}}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"ellipse"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"ellipse map = svgElement 'ellipse' ((isNil map) defaultEllipseMap map)"}},"arg":{"_type":"lambda","varName":"map","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"svgElement"},"arg":{"_type":"lit","value":"ellipse"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"isNil"},"arg":{"_type":"ref","varName":"map"}},"arg":{"_type":"ref","varName":"defaultEllipseMap"}},"arg":{"_type":"ref","varName":"map"}}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"line"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"line map = svgElement 'line' ((isNil map) defaultLineMap map)"}},"arg":{"_type":"lambda","varName":"map","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"svgElement"},"arg":{"_type":"lit","value":"line"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"isNil"},"arg":{"_type":"ref","varName":"map"}},"arg":{"_type":"ref","varName":"defaultLineMap"}},"arg":{"_type":"ref","varName":"map"}}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"text"}},"arg":{"_type":"lit","value":2}},"arg":{"_type":"lit","value":"text t map = svgNode concat['<text ' (insertFields ((isNil map) defaultTextMap map)) '>' ((isNil t) 'undefined' t) '</text>']"}},"arg":{"_type":"lambda","varName":"t","body":{"_type":"lambda","varName":"map","body":{"_type":"apply","func":{"_type":"ref","varName":"svgNode"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"<text "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"insertFields"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"isNil"},"arg":{"_type":"ref","varName":"map"}},"arg":{"_type":"ref","varName":"defaultTextMap"}},"arg":{"_type":"ref","varName":"map"}}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":">"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"isNil"},"arg":{"_type":"ref","varName":"t"}},"arg":{"_type":"lit","value":"undefined"}},"arg":{"_type":"ref","varName":"t"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"</text>"}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"polygon"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"polygon map = svgElement 'polygon' ((isNil map) defaultPolygonMap map)"}},"arg":{"_type":"lambda","varName":"map","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"svgElement"},"arg":{"_type":"lit","value":"polygon"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"isNil"},"arg":{"_type":"ref","varName":"map"}},"arg":{"_type":"ref","varName":"defaultPolygonMap"}},"arg":{"_type":"ref","varName":"map"}}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"group"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"group elem = svgNode concat['<g>' (elem id) '</g>']"}},"arg":{"_type":"lambda","varName":"elem","body":{"_type":"apply","func":{"_type":"ref","varName":"svgNode"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"<g>"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"elem"},"arg":{"_type":"ref","varName":"id"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"</g>"}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"translate"}},"arg":{"_type":"lit","value":3}},"arg":{"_type":"lit","value":"translate elem x y = svgNode concat['<g transform=\"translate(' x ' ' y ')\">' (elem id) '</g>']"}},"arg":{"_type":"lambda","varName":"elem","body":{"_type":"lambda","varName":"x","body":{"_type":"lambda","varName":"y","body":{"_type":"apply","func":{"_type":"ref","varName":"svgNode"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"<g transform=\"translate("}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"x"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":" "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"y"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":")\">"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"elem"},"arg":{"_type":"ref","varName":"id"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"</g>"}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}}}}}}}},
  {"_type":"anno","data":{"_type":"nil"},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"rotate"}},"arg":{"_type":"lit","value":2}},"arg":{"_type":"lit","value":"rotate elem r = svgNode concat['<g transform=\"rotate(' r ')\">' (elem id) '</g>']"}},"arg":{"_type":"lambda","varName":"elem","body":{"_type":"lambda","varName":"r","body":{"_type":"apply","func":{"_type":"ref","varName":"svgNode"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"<g transform=\"rotate("}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"r"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":")\">"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"elem"},"arg":{"_type":"ref","varName":"id"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"</g>"}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}}}}}
]