<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<title>environment.md</title>

</head>

<body>

<h1>Leisure environment</h1>

<h1>Codebases</h1>

<p>A codebase is a collection of documents with</p>

<ul>
<li>Function definitions</li>
<li>Automatic expressions that run on load</li>
<li>Test cases</li>
<li>Rich documentation</li>
</ul>

<p>If you query definitions, you can edit them directly in the results and they will change in their "home" documents.</p>

<h1>Storage</h1>

<ul>
<li>documents are HTML files with "pre" elements containing code
<ul>
<li>Code can contain comments</li>
<li>code in "pre" elements can float in "normal" HTML</li>
<li>inactive code shows a collapsed LeisureBar</li>
</ul></li>
<li>in-browser
<ul>
<li>body gets a version ID, stored the HTML file system</li>
<li>page gets a directory on the HTML file system</li>
<li>code elements each get a file, named with the "leisureName" attribute
<ul>
<li>if no leisureName, one is generated</li>
</ul></li>
<li>as you make changes, the browser file system stores them and increments the body's version id</li>
<li>when you open an HTML file, it does a version check
<ul>
<li>if there is a version conflict, Leisure offers to
<ol>
<li>restore the old version</li>
<li>use the new one, backing up the old</li>
<li>use the new one and wipe the old</li>
</ol></li>
</ul></li>
<li>file system layout
<ul>
<li>pagename.properties file
<ul>
<li>no-cache -- don't use storage for this page</li>
<li>version id</li>
</ul></li>
<li>pagename.dir directory
<ul>
<li>file for each code element</li>
</ul></li>
</ul></li>
</ul></li>
</ul>

</body>
</html>
