<html>
<head>
<script src="cp.js"></script>
<script src="game.js"></script>
<script src="bootLeisure.js"></script>
<script>
var LEFT_ARROW = 37
var UP_ARROW = 38
var RIGHT_ARROW = 39
var DOWN_ARROW = 40

function lEvt(win, funcName) {
  return function(evt) {
    Prim.leisureEvent(funcName, evt || win.event);
  }
}

function initChippy(svg) {
  Boot.onboot(function() {
    Boot.loadThen(['chippy', 'chip'], function(){
      var doc = svg.getSVGDocument();
      var win = chipwin = doc.defaultView;
      win.leisureEvent = leisureEvent
      Chippy.initChippy(doc);
      Game.bindSvgDiv(document.getElementById('floop'), lEvt(win, 'key'))
      lEvt(win, 'startChippy')(null);
    });
  });
}

</script>
</head>
<body>
  <table style="width: 100%; height: 100%">
    <tr style="height: 100%"><td style="width: 0; vertical-align: top">
	<div id="floop" tabindex="0" style="display: inline" onmousedown="this.focus()">
	  <object data="map2.svg" type="image/svg+xml" width="512" height="384" onload="initChippy(this)"></object>
	</div>
      </td>
      <td style="width: 100%"><pre leisureNode='code' style="height: 100%"></pre></td>
    </tr>
  </table>
</body>
</html>
