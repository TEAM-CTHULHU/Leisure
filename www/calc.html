<!DOCTYPE html>
<html>
  <head>
        <style>
                /*
                @media screen {
                        html, body {
                                font: 12px/15px sans-serif;
                                font: 24px/32px sans-serif;
                        }
                }
                @media handheld, screen and (max-width: 995px) {
                        html, body, button {
                                font: 100% sans-serif;
                                line-height: 64px;
                        }
                }
                */
                /*
                display: text: height 36px, (32, 0); 688x313
                key: 27px
                shift text: 17px

                MENU ROW
                size: 74x46
                tops: 364
                lefts: 23, 143, 263, 383, 503, 623
                TOP AREA
                size: 74x58
                tops: 444, 505, 607
                lefts: 23, 143, 263, 383, 503, 623
                ENTER ROW
                size: 194x58, 74x58
                tops: 748
                lefts: 23, 263, 383, 503, 623
                NUMBER KEYS
                size: 98x59
                tops: 850, 952, 1053, 1155
                lefts: 23, 167, 311, 455, 599
                */
                .loading #calc {
                        display: none;
                }
                #loading {
                        display: none;
                }
                .loading #loading {
                        display: block;
                }
                pre[leisureNode='code'] {
                        outline: solid black 2px;
                        display: inline-block;
                        padding: 10px;
                        position: relative;
                }
                .hidden,
                div[maindoc] {
                        display: none;
                }
                .selected {
                        border: solid black 2px;
                }
                #calc {
                        width: calc(100% - 10px);
                        margin-left: 5px;
                }
                #input,
                #output,
                #simplified,
                #ast,
                #code {
                        padding: 0.5ex;
                        display: inline-block;
                        /*
                        min-width: 50ex;
                        max-width: 90%;
                        */
                        width: calc(100% - 1ex - 4px);
                        min-height: 1em;
                        white-space: pre-wrap;
                        word-wrap: break-word;
                        position: relative;
                }
                #input {
                        border: solid blue 2px;
                }
                #output {
                        border: solid black 2px;
                }
                #simplified,
                #code,
                #ast {
                        border: solid green 2px;
                }
                #output.err {
                        border: solid red 4px;
                }
        </style>
        <!-- link href='http://fonts.googleapis.com/css?family=Oxygen:400,700' rel='stylesheet' type='text/css' -->
        <link href='jquery-ui/css/leisure/jquery-ui-1.9.2.custom.min.css' rel='stylesheet' type='text/css'>
        <script src="http://www.google.com/jsapi?autoload=%7B%22modules%22%3A%5B%7B%22name%22%3A%22picker%22%2C%22version%22%3A%221%22%7D%5D%7D"></script>
        <script src="jquery-ui/js/jquery-1.8.2.js"></script>
        <script src="jquery-ui/js/jquery-ui-1.9.1.custom.js"></script>
        <script src="xus.js"></script>
        <script language="javascript">
          function start() {
                setTimeout(function() {
                        window.Leisure = {calc: true}
                        var script = document.createElement('script');
                        script.src = "bootLeisure.js?uniq=" + Math.random();
                        script.onload = function() {
                                console.log("adding boot callback...");
                                Boot.onboot(function() {
                                        Leisure.configureCalc($('#input'), $('#output'), $('#simplified'), $('#ast'), $('#code'));
                                        $('#input').attr('contenteditable', 'true').html('').focus();
                                        Leisure.useSkin();
                                });
                        }
                        document.head.appendChild(script);
                }, 1);
          }
        </script>
  </head>
  <body style="position: relative; margin: 0" class="loading">
    <div id="loading">LOADING CALC</div>
    <div id="calc">
      <div id='inputLabel'>Input</div>
      <div id='input'>LOADING...</div><br>
      <div id='outputLabel'>Output  <button id='simplifiedButton'>Simplified</button> <button id='astButton'>AST</button> <button id='codeButton'>Code</button> <button id='allButton'>All</button></div>
      <div id='output'></div><br>
      <br>
      <div id="simplifiedPanel" class="hidden">
        <div id='simplifiedLabel'>Simplified</div>
        <div id='simplified'></div><br>
      </div>
      <div id="astPanel" class="hidden" style="position: relative">
        <div id='astLabel'>AST</div>
        <div id='ast'></div><br>
      </div>
      <div id="codePanel" class="hidden">
        Code<br>
        <div id='code'></div><br>
      </div>
    </div>
<div maindoc><!--
*** Basic defs
-
```
html x = \f . f x
```
*** Leisure Controls
<button id='saveButton'>Save</button><br>
<button id='openUriButton'>Open</button>
<input id='openUriText' type='text'><br>
<button id='saveAsButton'>Save as</button>
<input id='saveAsText' type='text'><br>
<button id='toggleHiddenPages' type='checkbox'>Toggle Hidden Pages</button><br>
<button id='openFromGdriveButton'>Open from Google Drive</button>
*** Leisure control code
-
```
toggleHidden=do
  hidden <- getValue 'hiddenPages'
  setHidden (not hidden)

setHidden hide=do
  js hide
    "$(document.body).removeClass('showHidden'); $(document.body).addClass('hideControls')"
    "$(document.body).addClass('showHidden hideControls')"
  setValue 'hiddenPages' hide

openUriButton=do
  fname <- js "$('#saveAsText').val()"
  open fname

saveButton=do
  setHidden true
  save

saveAsButton=do
  setHidden true
  fname <- js "$('#saveAsText').val()"
  saveAs fname

#@auto "mode": "notebook"
do
  bindEvent '#openFromGdriveButton' 'click' \e . gdriveOpen
  bindEvent '#saveButton' 'click' \e . saveButton
  bindEvent '#openUriButton' 'click' \e . openUriButton
  bindEvent '#saveAsButton' 'click' \e . saveAsButton
  bindEvent '#toggleHiddenPages' 'click' \e . toggleHidden
  js["$('#openUriText').val('" uri "')"]
  js["$('#saveAsText').val('" uri "')"]
  js["window.setTimeout(function(){$('[leisurenode=code]').addClass('ui-widget-overlay ui-corner-all').attr('style', 'width: auto; opacity: 1')}, 1)"]
  js["window.initButton = function(btn){window.setTimeout(function(){var p = btn[0].parentElement; if (p.firstChild != p.lastChild && !p.firstChild.initialized){p.firstChild.initialized = true; $(p.firstChild).attr('class', 'kill-button').html('').button({icons: {primary: 'ui-icon-circle-close'}, text: false}); $([p.firstChild.nextSibling.nextSibling, p.lastChild]).css('padding', '1px').css('margin-top', '1px')}}, 1)}"]
  js["window.setTimeout(function(){$('.controls').each(function(index, c){if (c.firstChild==c.lastChild){$(c.firstChild).attr('class', 'arrow-button').html('').button({icons: {primary: 'ui-icon-arrowthick-1-e'}, text: false}).on('click', function(){initButton($(this))})}})}, 1)"]
  js["window.setTimeout(function(){$('.ui-state-error').removeClass('.ui-state-error')}, 100)"]
  js["$('[maindoc]').append($('#header'))"]
```
*** Hidden Page
-
This is hidden
***Examples
```
#@auto "mode": "notebook"
print 'This runs automatically'

js[
  "alert(" (3 + 4) ")"]
```
--></div>
<script>start()</script>
  </body>
</html>
