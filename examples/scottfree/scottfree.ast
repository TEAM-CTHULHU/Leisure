[
  {"_type":"apply","func":{"_type":"ref","varName":"require"},"arg":{"_type":"lit","value":"../../newCode/std.lsr"}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"peek"}},"arg":{"_type":"lit","value":2}},"arg":{"_type":"lit","value":"peek name idx = do\n  global <- getValue name\n  > (length global) idx\n    at global idx\n    print \"ERROR: PEEK OUT OF BOUNDS\""}},"arg":{"_type":"lambda","varName":"name","body":{"_type":"lambda","varName":"idx","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"getValue"},"arg":{"_type":"ref","varName":"name"}}},"arg":{"_type":"lambda","varName":"global","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":">"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"length"},"arg":{"_type":"ref","varName":"global"}}},"arg":{"_type":"ref","varName":"idx"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"at"},"arg":{"_type":"ref","varName":"global"}},"arg":{"_type":"ref","varName":"idx"}}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"lit","value":"ERROR: PEEK OUT OF BOUNDS"}}}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"poke"}},"arg":{"_type":"lit","value":3}},"arg":{"_type":"lit","value":"poke name idx value = do\n  global <- getValue name\n  > (length global) idx\n    do \n      new_global = append (take idx global) (append [ value ] (drop (++ idx) global) )\n      setValue name new_global\n      value\n    print \"ERROR: POKE OUT OF BOUNDS\""}},"arg":{"_type":"lambda","varName":"name","body":{"_type":"lambda","varName":"idx","body":{"_type":"lambda","varName":"value","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"getValue"},"arg":{"_type":"ref","varName":"name"}}},"arg":{"_type":"lambda","varName":"global","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":">"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"length"},"arg":{"_type":"ref","varName":"global"}}},"arg":{"_type":"ref","varName":"idx"}},"arg":{"_type":"let","varName":"new_global","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"append"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"take"},"arg":{"_type":"ref","varName":"idx"}},"arg":{"_type":"ref","varName":"global"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"append"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"value"}},"arg":{"_type":"ref","varName":"nil"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"drop"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"++"},"arg":{"_type":"ref","varName":"idx"}}},"arg":{"_type":"ref","varName":"global"}}}},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"setValue"},"arg":{"_type":"ref","varName":"name"}},"arg":{"_type":"ref","varName":"new_global"}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"ref","varName":"value"}}}}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"lit","value":"ERROR: POKE OUT OF BOUNDS"}}}}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"LIGHT_SOURCE"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"LIGHT_SOURCE = 9  # light is always at index 9"}},"arg":{"_type":"lit","value":9}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"DESTROYED"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"DESTROYED = 0     # room location for 'destroyed' items"}},"arg":{"_type":"lit","value":0}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"CARRIED"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"CARRIED = 255     # room location for carried items"}},"arg":{"_type":"lit","value":255}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"DARKBIT"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"DARKBIT = 15"}},"arg":{"_type":"lit","value":15}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"LIGHTOUTBIT"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"LIGHTOUTBIT = 16"}},"arg":{"_type":"lit","value":16}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"GH_MAGIC"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"GH_MAGIC = 0"}},"arg":{"_type":"lit","value":0}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"GH_NUM_ITEMS"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"GH_NUM_ITEMS = 1"}},"arg":{"_type":"lit","value":1}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"GM_NUM_ACTIONS"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"GM_NUM_ACTIONS = 2"}},"arg":{"_type":"lit","value":2}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"GH_NUM_WORDS"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"GH_NUM_WORDS = 3   # shorter list of nouns and verbs is padded"}},"arg":{"_type":"lit","value":3}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"GH_NUM_ROOMS"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"GH_NUM_ROOMS = 4"}},"arg":{"_type":"lit","value":4}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"GH_MAX_CARRY"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"GH_MAX_CARRY = 5"}},"arg":{"_type":"lit","value":5}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"GH_PLAYER_ROOM"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"GH_PLAYER_ROOM = 6"}},"arg":{"_type":"lit","value":6}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"GH_NUM_TREASURES"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"GH_NUM_TREASURES = 7"}},"arg":{"_type":"lit","value":7}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"GH_WORD_LENGTH"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"GH_WORD_LENGTH = 8"}},"arg":{"_type":"lit","value":8}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"GH_LIGHT_TIME"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"GH_LIGHT_TIME = 9"}},"arg":{"_type":"lit","value":9}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"GH_NUM_MESSAGES"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"GH_NUM_MESSAGES = 10"}},"arg":{"_type":"lit","value":10}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"GH_TREASURE_ROOM"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"GH_TREASURE_ROOM = 11"}},"arg":{"_type":"lit","value":11}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"GH_SIZEOF"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"GH_SIZEOF = 12"}},"arg":{"_type":"lit","value":12}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"LIGHT_REFILL"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"LIGHT_REFILL = 0"}},"arg":{"_type":"lit","value":0}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"REDRAW"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"REDRAW = 1"}},"arg":{"_type":"lit","value":1}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"conditions"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"conditions = [ '' 'HAS' 'IS_in_AR' 'IS_AVAIL' 'PLAYER_IN' 'IS_NOT_in_AR' 'HAS_NOT' 'PLAYER_NOT_IN' 'SET_BIT' 'CLEARED_BIT' 'HAS_SOMETHING' 'HAS_NOTHING' 'IS_NOT_AVAIL' 'IS_NOT_in_ROOM0' 'IS_in_ROOM0' 'COUNTER <=' 'COUNTER >' 'IS_in_OrigROOM' 'IS_NOT_in_OrigROOM' 'COUNTER ==' ]"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":""}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"HAS"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"IS_in_AR"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"IS_AVAIL"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"PLAYER_IN"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"IS_NOT_in_AR"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"HAS_NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"PLAYER_NOT_IN"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"SET_BIT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"CLEARED_BIT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"HAS_SOMETHING"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"HAS_NOTHING"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"IS_NOT_AVAIL"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"IS_NOT_in_ROOM0"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"IS_in_ROOM0"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"COUNTER <="}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"COUNTER >"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"IS_in_OrigROOM"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"IS_NOT_in_OrigROOM"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"COUNTER =="}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}}}}}}}}}}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"NONE"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"NONE = 1"}},"arg":{"_type":"lit","value":1}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"ACTION"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"ACTION = 2"}},"arg":{"_type":"lit","value":2}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"ITEM"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"ITEM = 3"}},"arg":{"_type":"lit","value":3}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"ROOM"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"ROOM = 4"}},"arg":{"_type":"lit","value":4}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"NUMBER"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"NUMBER = 5"}},"arg":{"_type":"lit","value":5}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"BITFLAG"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"BITFLAG = 6"}},"arg":{"_type":"lit","value":6}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"conddata"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"conddata = [  ACTION ITEM ITEM ITEM ROOM ITEM ITEM ROOM BITFLAG BITFLAG NONE NONE ITEM ITEM ITEM NUMBER NUMBER ITEM ITEM NUMBER ]"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"ACTION"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"ITEM"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"ITEM"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"ITEM"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"ROOM"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"ITEM"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"ITEM"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"ROOM"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"BITFLAG"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"BITFLAG"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NONE"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NONE"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"ITEM"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"ITEM"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"ITEM"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NUMBER"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NUMBER"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"ITEM"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"ITEM"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NUMBER"}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}}}}}}}}}}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"acts"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"acts = flatten [\n  ['GET' 'MOVE_INTO_AR' 'GOTO' 'REMOVE' 'SET_NIGHT']\n  ['SET_DAY' 'SET_BIT' 'REMOVE' 'CLEAR_BIT' 'KILL_PLAYER']\n  ['MOVE_X_INTO_Y' 'QUIT' 'LOOK' 'SCORE' 'INVENTORY']\n  ['SET_BIT (0)' 'CLEAR_BIT (0)' 'FILL_LAMP' 'CLS' 'SAVE']\n  ['SWAP_ITEMS' 'CONTINUE:' 'GET_ALWAYS' 'PUT_X_WITH_Y' 'LOOK']\n  ['COUNTER -= 1' 'PRINT_COUNTER' 'COUNTER =' 'SWAP_LOC_RV' 'SWAP_COUNTER']\n  ['COUNTER +=' 'COUNTER -=' 'ECHO_NOUN' 'ECHO_NOUN_CR' 'CR']\n  ['SELECT_RV' 'DELAY' 'SHOW_PIC' 'COMM90' 'COMM91']\n  ['COMM92' 'COMM93' 'COMM94' 'COMM95' 'COMM96']\n  ['COMM97' 'COMM98' 'COMM99' 'COMM100' 'COMM101'] ]"}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"flatten"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"GET"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"MOVE_INTO_AR"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"GOTO"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"REMOVE"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"SET_NIGHT"}},"arg":{"_type":"ref","varName":"nil"}}}}}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"SET_DAY"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"SET_BIT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"REMOVE"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"CLEAR_BIT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"KILL_PLAYER"}},"arg":{"_type":"ref","varName":"nil"}}}}}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"MOVE_X_INTO_Y"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"QUIT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"LOOK"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"SCORE"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"INVENTORY"}},"arg":{"_type":"ref","varName":"nil"}}}}}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"SET_BIT (0)"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"CLEAR_BIT (0)"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"FILL_LAMP"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"CLS"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"SAVE"}},"arg":{"_type":"ref","varName":"nil"}}}}}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"SWAP_ITEMS"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"CONTINUE:"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"GET_ALWAYS"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"PUT_X_WITH_Y"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"LOOK"}},"arg":{"_type":"ref","varName":"nil"}}}}}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"COUNTER -= 1"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"PRINT_COUNTER"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"COUNTER ="}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"SWAP_LOC_RV"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"SWAP_COUNTER"}},"arg":{"_type":"ref","varName":"nil"}}}}}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"COUNTER +="}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"COUNTER -="}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"ECHO_NOUN"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"ECHO_NOUN_CR"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"CR"}},"arg":{"_type":"ref","varName":"nil"}}}}}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"SELECT_RV"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"DELAY"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"SHOW_PIC"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"COMM90"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"COMM91"}},"arg":{"_type":"ref","varName":"nil"}}}}}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"COMM92"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"COMM93"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"COMM94"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"COMM95"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"COMM96"}},"arg":{"_type":"ref","varName":"nil"}}}}}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"COMM97"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"COMM98"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"COMM99"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"COMM100"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"COMM101"}},"arg":{"_type":"ref","varName":"nil"}}}}}}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"NOT"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"NOT = 0"}},"arg":{"_type":"lit","value":0}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"IT"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"IT = 1"}},"arg":{"_type":"lit","value":1}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"RO"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"RO = 2"}},"arg":{"_type":"lit","value":2}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"FL"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"FL = 3"}},"arg":{"_type":"lit","value":3}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"IT_RO"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"IT_RO = 4"}},"arg":{"_type":"lit","value":4}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"IT_IT"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"IT_IT = 5"}},"arg":{"_type":"lit","value":5}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"NUM"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"NUM = 6"}},"arg":{"_type":"lit","value":6}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"actdata"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"actdata = flatten [\n  [IT IT RO IT NOT NOT FL IT FL NOT]\n  [IT_RO NOT NOT NOT NOT NOT NOT NOT NOT NOT]\n  [IT_IT NOT IT IT_IT NOT NOT NOT NUM NOT FL]\n  [NUM NUM NOT NOT NOT FL NOT FL NOT NOT]\n  [NOT NOT NOT NOT NOT NOT NOT NOT NOT NOT] ]"}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"flatten"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"IT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"IT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"RO"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"IT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"FL"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"IT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"FL"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}}}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"IT_RO"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}}}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"IT_IT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"IT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"IT_IT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NUM"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"FL"}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}}}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NUM"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NUM"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"FL"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"FL"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}}}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"NOT"}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}}}}},"arg":{"_type":"ref","varName":"nil"}}}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"Exits"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"Exits = [ 'North' 'South' 'East' 'West' 'Up' 'Down' ]"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"North"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"South"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"East"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"West"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"Up"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"Down"}},"arg":{"_type":"ref","varName":"nil"}}}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"loadGame"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"loadGame filename = do\n  result <- readFile filename\n  result\n    \\err . print concat[ 'Error: ' err ]\n    \\contents . processFile (everyLinesForFile contents)"}},"arg":{"_type":"lambda","varName":"filename","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"readFile"},"arg":{"_type":"ref","varName":"filename"}}},"arg":{"_type":"lambda","varName":"result","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"result"},"arg":{"_type":"lambda","varName":"err","body":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"Error: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"err"}},"arg":{"_type":"ref","varName":"nil"}}}}}}},"arg":{"_type":"lambda","varName":"contents","body":{"_type":"apply","func":{"_type":"ref","varName":"processFile"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"everyLinesForFile"},"arg":{"_type":"ref","varName":"contents"}}}}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"everyLinesForFile"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"everyLinesForFile text =  collapseStrings (strSplit text '\\\\r?\\\\n')"}},"arg":{"_type":"lambda","varName":"text","body":{"_type":"apply","func":{"_type":"ref","varName":"collapseStrings"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"strSplit"},"arg":{"_type":"ref","varName":"text"}},"arg":{"_type":"lit","value":"\\r?\\n"}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"collapseStrings"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"collapseStrings list = isNil list\n   list\n   isPartialString (head list)\n     collapseStrings (cons ((head list) + '{nl}' + (head (tail list))) (tail (tail list)))\n     cons (head list) (collapseStrings (tail list))"}},"arg":{"_type":"lambda","varName":"list","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"isNil"},"arg":{"_type":"ref","varName":"list"}},"arg":{"_type":"ref","varName":"list"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"isPartialString"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"head"},"arg":{"_type":"ref","varName":"list"}}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"collapseStrings"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"+"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"+"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"head"},"arg":{"_type":"ref","varName":"list"}}},"arg":{"_type":"lit","value":"{nl}"}}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"head"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"tail"},"arg":{"_type":"ref","varName":"list"}}}}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"tail"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"tail"},"arg":{"_type":"ref","varName":"list"}}}}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"head"},"arg":{"_type":"ref","varName":"list"}}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"collapseStrings"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"tail"},"arg":{"_type":"ref","varName":"list"}}}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"isPartialString"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"isPartialString string = strMatches string '^\".*\"\\\\s+[0-9]+\\\\s*$'\n  false\n  strMatches string '^\".*[^\"]\\\\s*$'"}},"arg":{"_type":"lambda","varName":"string","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"strMatches"},"arg":{"_type":"ref","varName":"string"}},"arg":{"_type":"lit","value":"^\".*\"\\s+[0-9]+\\s*$"}},"arg":{"_type":"ref","varName":"false"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"strMatches"},"arg":{"_type":"ref","varName":"string"}},"arg":{"_type":"lit","value":"^\".*[^\"]\\s*$"}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"asInts"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"asInts list = map (* 1) list"}},"arg":{"_type":"lambda","varName":"list","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"map"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"*"},"arg":{"_type":"lit","value":1}}},"arg":{"_type":"ref","varName":"list"}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"extract"}},"arg":{"_type":"lit","value":2}},"arg":{"_type":"lit","value":"extract str pattern = do\n  matches = strMatch str pattern\n  isCons matches\n    isNil (at matches 1)\n      ''\n      head (at matches 1)\n    str"}},"arg":{"_type":"lambda","varName":"str","body":{"_type":"lambda","varName":"pattern","body":{"_type":"let","varName":"matches","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"strMatch"},"arg":{"_type":"ref","varName":"str"}},"arg":{"_type":"ref","varName":"pattern"}},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"isCons"},"arg":{"_type":"ref","varName":"matches"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"isNil"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"at"},"arg":{"_type":"ref","varName":"matches"}},"arg":{"_type":"lit","value":1}}},"arg":{"_type":"lit","value":""}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"head"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"at"},"arg":{"_type":"ref","varName":"matches"}},"arg":{"_type":"lit","value":1}}}}},"arg":{"_type":"ref","varName":"str"}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"unquote"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"unquote str = extract str (regexp '^\"(.*)\"$')\n    "}},"arg":{"_type":"lambda","varName":"str","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"extract"},"arg":{"_type":"ref","varName":"str"}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"regexp"},"arg":{"_type":"lit","value":"^\"(.*)\"$"}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"asRoom"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"asRoom list = append (asInts (removeLast list)) [ (unquote (last list)) ]"}},"arg":{"_type":"lambda","varName":"list","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"append"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"asInts"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"removeLast"},"arg":{"_type":"ref","varName":"list"}}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"unquote"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"last"},"arg":{"_type":"ref","varName":"list"}}}},"arg":{"_type":"ref","varName":"nil"}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"asRooms"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"asRooms list = map (asRoom) list"}},"arg":{"_type":"lambda","varName":"list","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"map"},"arg":{"_type":"ref","varName":"asRoom"}},"arg":{"_type":"ref","varName":"list"}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"asItem"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"asItem string = do\n  matches = strMatch string '^(\"?.*\"?)\\\\s+([0-9]+)\\\\s*$'\n  isCons matches\n    do\n      name = unquote (head (at matches 1))\n      room = 1 * (at (at matches 1) 1)\n      agmatch = strMatch name '/(.*)/'\n      isCons agmatch\n        [ (strReplace name (regexp '/.*/') '') room (head (at agmatch 1)) ]\n        [ name room '' ]\n    [ string 0 'BAD REGEXP' ]      "}},"arg":{"_type":"lambda","varName":"string","body":{"_type":"let","varName":"matches","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"strMatch"},"arg":{"_type":"ref","varName":"string"}},"arg":{"_type":"lit","value":"^(\"?.*\"?)\\s+([0-9]+)\\s*$"}},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"isCons"},"arg":{"_type":"ref","varName":"matches"}},"arg":{"_type":"let","varName":"name","value":{"_type":"apply","func":{"_type":"ref","varName":"unquote"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"head"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"at"},"arg":{"_type":"ref","varName":"matches"}},"arg":{"_type":"lit","value":1}}}},"body":{"_type":"let","varName":"room","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"*"},"arg":{"_type":"lit","value":1}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"at"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"at"},"arg":{"_type":"ref","varName":"matches"}},"arg":{"_type":"lit","value":1}}},"arg":{"_type":"lit","value":1}}},"body":{"_type":"let","varName":"agmatch","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"strMatch"},"arg":{"_type":"ref","varName":"name"}},"arg":{"_type":"lit","value":"/(.*)/"}},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"isCons"},"arg":{"_type":"ref","varName":"agmatch"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"strReplace"},"arg":{"_type":"ref","varName":"name"}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"regexp"},"arg":{"_type":"lit","value":"/.*/"}}},"arg":{"_type":"lit","value":""}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"room"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"head"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"at"},"arg":{"_type":"ref","varName":"agmatch"}},"arg":{"_type":"lit","value":1}}}},"arg":{"_type":"ref","varName":"nil"}}}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"name"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"room"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":""}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"string"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"BAD REGEXP"}},"arg":{"_type":"ref","varName":"nil"}}}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"asItems"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"asItems list = map (asItem) list  "}},"arg":{"_type":"lambda","varName":"list","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"map"},"arg":{"_type":"ref","varName":"asItem"}},"arg":{"_type":"ref","varName":"list"}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"processFile"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"processFile contents = do\n  #print contents\n  #print (at contents 0)\n  setValue 'BitFlags' [ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ]  # up to 32 bits of flags supported\n  GameHeader = asInts (take GH_SIZEOF contents)\n  setValue 'GameHeader' GameHeader\n  GlobalVars = [ (at GameHeader GH_LIGHT_TIME) 0 ]  # store light time in refill time for later use\n  setValue 'GlobalVars' GlobalVars\n  after_header = (drop GH_SIZEOF contents)\n  num_actions = (at GameHeader GM_NUM_ACTIONS)\n  max_actions = (num_actions * 1 + 1) * 8\n  #print concat[ 'num actions: ' num_actions ' max actions: ' max_actions]\n  Actions = asInts (box 8 (take max_actions after_header))\n  setValue 'Actions' Actions\n  after_actions = drop max_actions after_header\n  num_words = at GameHeader GH_NUM_WORDS\n  max_words = (num_words * 1 + 1) * 2\n  Words = take max_words after_actions\n  setValue 'Nouns' (evens Words)\n  setValue 'Verbs' (odds Words)\n  after_words = drop max_words after_actions\n  processFile2 after_words\n  "}},"arg":{"_type":"lambda","varName":"contents","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"setValue"},"arg":{"_type":"lit","value":"BitFlags"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"let","varName":"GameHeader","value":{"_type":"apply","func":{"_type":"ref","varName":"asInts"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"take"},"arg":{"_type":"ref","varName":"GH_SIZEOF"}},"arg":{"_type":"ref","varName":"contents"}}},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"setValue"},"arg":{"_type":"lit","value":"GameHeader"}},"arg":{"_type":"ref","varName":"GameHeader"}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"let","varName":"GlobalVars","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"at"},"arg":{"_type":"ref","varName":"GameHeader"}},"arg":{"_type":"ref","varName":"GH_LIGHT_TIME"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"ref","varName":"nil"}}},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"setValue"},"arg":{"_type":"lit","value":"GlobalVars"}},"arg":{"_type":"ref","varName":"GlobalVars"}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"let","varName":"after_header","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"drop"},"arg":{"_type":"ref","varName":"GH_SIZEOF"}},"arg":{"_type":"ref","varName":"contents"}},"body":{"_type":"let","varName":"num_actions","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"at"},"arg":{"_type":"ref","varName":"GameHeader"}},"arg":{"_type":"ref","varName":"GM_NUM_ACTIONS"}},"body":{"_type":"let","varName":"max_actions","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"*"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"+"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"*"},"arg":{"_type":"ref","varName":"num_actions"}},"arg":{"_type":"lit","value":1}}},"arg":{"_type":"lit","value":1}}},"arg":{"_type":"lit","value":8}},"body":{"_type":"let","varName":"Actions","value":{"_type":"apply","func":{"_type":"ref","varName":"asInts"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"box"},"arg":{"_type":"lit","value":8}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"take"},"arg":{"_type":"ref","varName":"max_actions"}},"arg":{"_type":"ref","varName":"after_header"}}}},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"setValue"},"arg":{"_type":"lit","value":"Actions"}},"arg":{"_type":"ref","varName":"Actions"}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"let","varName":"after_actions","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"drop"},"arg":{"_type":"ref","varName":"max_actions"}},"arg":{"_type":"ref","varName":"after_header"}},"body":{"_type":"let","varName":"num_words","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"at"},"arg":{"_type":"ref","varName":"GameHeader"}},"arg":{"_type":"ref","varName":"GH_NUM_WORDS"}},"body":{"_type":"let","varName":"max_words","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"*"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"+"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"*"},"arg":{"_type":"ref","varName":"num_words"}},"arg":{"_type":"lit","value":1}}},"arg":{"_type":"lit","value":1}}},"arg":{"_type":"lit","value":2}},"body":{"_type":"let","varName":"Words","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"take"},"arg":{"_type":"ref","varName":"max_words"}},"arg":{"_type":"ref","varName":"after_actions"}},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"setValue"},"arg":{"_type":"lit","value":"Nouns"}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"evens"},"arg":{"_type":"ref","varName":"Words"}}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"setValue"},"arg":{"_type":"lit","value":"Verbs"}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"odds"},"arg":{"_type":"ref","varName":"Words"}}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"let","varName":"after_words","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"drop"},"arg":{"_type":"ref","varName":"max_words"}},"arg":{"_type":"ref","varName":"after_actions"}},"body":{"_type":"apply","func":{"_type":"ref","varName":"processFile2"},"arg":{"_type":"ref","varName":"after_words"}}}}}}}}}}}}}}}}}}}}}}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"processFile2"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"processFile2 after_words = do \n  GameHeader <- getValue 'GameHeader'\n  num_actions = (at GameHeader GM_NUM_ACTIONS)  \n  num_rooms = at GameHeader GH_NUM_ROOMS\n  max_rooms = (num_rooms * 1 + 1) * 7\n  Rooms = asRooms (box 7 (take max_rooms after_words))\n  setValue 'Rooms' Rooms\n  after_rooms = drop max_rooms after_words\n  num_msgs = (at GameHeader GH_NUM_MESSAGES)\n  max_msgs = num_msgs * 1 + 1\n  Messages = take max_msgs after_rooms\n  setValue 'Messages' Messages\n  after_msgs = drop max_msgs after_rooms\n  num_items = at GameHeader GH_NUM_ITEMS\n  max_items = num_items * 1 + 1\n  Items = asItems (take max_items after_msgs)\n  setValue 'Items' Items\n  after_items = drop max_items after_msgs\n  Comments = take (num_actions * 1 + 1) after_items\n  setValue 'Comments' Comments\n  after_comments = drop (num_actions * 1 + 1) after_items\n  GameFooter = asInts (take 3 after_comments)\n  setValue 'GameFooter' GameFooter\n  \"Data File Loaded.\""}},"arg":{"_type":"lambda","varName":"after_words","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"getValue"},"arg":{"_type":"lit","value":"GameHeader"}}},"arg":{"_type":"lambda","varName":"GameHeader","body":{"_type":"let","varName":"num_actions","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"at"},"arg":{"_type":"ref","varName":"GameHeader"}},"arg":{"_type":"ref","varName":"GM_NUM_ACTIONS"}},"body":{"_type":"let","varName":"num_rooms","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"at"},"arg":{"_type":"ref","varName":"GameHeader"}},"arg":{"_type":"ref","varName":"GH_NUM_ROOMS"}},"body":{"_type":"let","varName":"max_rooms","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"*"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"+"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"*"},"arg":{"_type":"ref","varName":"num_rooms"}},"arg":{"_type":"lit","value":1}}},"arg":{"_type":"lit","value":1}}},"arg":{"_type":"lit","value":7}},"body":{"_type":"let","varName":"Rooms","value":{"_type":"apply","func":{"_type":"ref","varName":"asRooms"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"box"},"arg":{"_type":"lit","value":7}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"take"},"arg":{"_type":"ref","varName":"max_rooms"}},"arg":{"_type":"ref","varName":"after_words"}}}},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"setValue"},"arg":{"_type":"lit","value":"Rooms"}},"arg":{"_type":"ref","varName":"Rooms"}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"let","varName":"after_rooms","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"drop"},"arg":{"_type":"ref","varName":"max_rooms"}},"arg":{"_type":"ref","varName":"after_words"}},"body":{"_type":"let","varName":"num_msgs","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"at"},"arg":{"_type":"ref","varName":"GameHeader"}},"arg":{"_type":"ref","varName":"GH_NUM_MESSAGES"}},"body":{"_type":"let","varName":"max_msgs","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"+"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"*"},"arg":{"_type":"ref","varName":"num_msgs"}},"arg":{"_type":"lit","value":1}}},"arg":{"_type":"lit","value":1}},"body":{"_type":"let","varName":"Messages","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"take"},"arg":{"_type":"ref","varName":"max_msgs"}},"arg":{"_type":"ref","varName":"after_rooms"}},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"setValue"},"arg":{"_type":"lit","value":"Messages"}},"arg":{"_type":"ref","varName":"Messages"}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"let","varName":"after_msgs","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"drop"},"arg":{"_type":"ref","varName":"max_msgs"}},"arg":{"_type":"ref","varName":"after_rooms"}},"body":{"_type":"let","varName":"num_items","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"at"},"arg":{"_type":"ref","varName":"GameHeader"}},"arg":{"_type":"ref","varName":"GH_NUM_ITEMS"}},"body":{"_type":"let","varName":"max_items","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"+"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"*"},"arg":{"_type":"ref","varName":"num_items"}},"arg":{"_type":"lit","value":1}}},"arg":{"_type":"lit","value":1}},"body":{"_type":"let","varName":"Items","value":{"_type":"apply","func":{"_type":"ref","varName":"asItems"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"take"},"arg":{"_type":"ref","varName":"max_items"}},"arg":{"_type":"ref","varName":"after_msgs"}}},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"setValue"},"arg":{"_type":"lit","value":"Items"}},"arg":{"_type":"ref","varName":"Items"}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"let","varName":"after_items","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"drop"},"arg":{"_type":"ref","varName":"max_items"}},"arg":{"_type":"ref","varName":"after_msgs"}},"body":{"_type":"let","varName":"Comments","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"take"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"+"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"*"},"arg":{"_type":"ref","varName":"num_actions"}},"arg":{"_type":"lit","value":1}}},"arg":{"_type":"lit","value":1}}},"arg":{"_type":"ref","varName":"after_items"}},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"setValue"},"arg":{"_type":"lit","value":"Comments"}},"arg":{"_type":"ref","varName":"Comments"}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"let","varName":"after_comments","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"drop"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"+"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"*"},"arg":{"_type":"ref","varName":"num_actions"}},"arg":{"_type":"lit","value":1}}},"arg":{"_type":"lit","value":1}}},"arg":{"_type":"ref","varName":"after_items"}},"body":{"_type":"let","varName":"GameFooter","value":{"_type":"apply","func":{"_type":"ref","varName":"asInts"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"take"},"arg":{"_type":"lit","value":3}},"arg":{"_type":"ref","varName":"after_comments"}}},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"setValue"},"arg":{"_type":"lit","value":"GameFooter"}},"arg":{"_type":"ref","varName":"GameFooter"}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"lit","value":"Data File Loaded."}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"merge"}},"arg":{"_type":"lit","value":2}},"arg":{"_type":"lit","value":"merge list1 list2 = isNil list1\n  nil\n  isNil list2\n    nil\n    append [ (head list1) (head list2) ] (merge (tail list1) (tail list2))"}},"arg":{"_type":"lambda","varName":"list1","body":{"_type":"lambda","varName":"list2","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"isNil"},"arg":{"_type":"ref","varName":"list1"}},"arg":{"_type":"ref","varName":"nil"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"isNil"},"arg":{"_type":"ref","varName":"list2"}},"arg":{"_type":"ref","varName":"nil"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"append"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"head"},"arg":{"_type":"ref","varName":"list1"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"head"},"arg":{"_type":"ref","varName":"list2"}}},"arg":{"_type":"ref","varName":"nil"}}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"merge"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"tail"},"arg":{"_type":"ref","varName":"list1"}}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"tail"},"arg":{"_type":"ref","varName":"list2"}}}}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"debugGame"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"debugGame = do\n  GameHeader <- getValue 'GameHeader'\n  print (merge [ '\\nmagic: ' '\\nnum items: ' '\\nnum actions: ' '\\nnum words: ' '\\nnum rooms: ' '\\nmax carry: ' '\\nplayer room: ' '\\ntreasures: ' '\\nword len: ' '\\nlight time: ' '\\nnum msgs: ' '\\ntreasure room: ' ] GameHeader)\n  GlobalVars <- getValue 'GlobalVars'\n  print (merge [ '\\nlight refill: ' '\\nredraw: ' ] GlobalVars)\n  Actions <- getValue 'Actions'\n  print concat[ \"\\nNum Actions: \" (length Actions) \"\\nFirst Action: \" (at Actions 0) \"\\nLast Action: \" (last Actions) ]\n  Nouns <- getValue 'Nouns'\n  print concat[ \"\\nNum Nouns: \" (length Nouns) \" Nouns: \" Nouns]\n  Verbs <- getValue 'Verbs'\n  print concat[ \"\\nNum Verbs: \" (length Verbs) \" Verbs: \" Verbs]\n  debugGame2\n  "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"getValue"},"arg":{"_type":"lit","value":"GameHeader"}}},"arg":{"_type":"lambda","varName":"GameHeader","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"merge"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nmagic: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nnum items: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nnum actions: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nnum words: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nnum rooms: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nmax carry: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nplayer room: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\ntreasures: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nword len: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nlight time: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nnum msgs: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\ntreasure room: "}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}}}}}}},"arg":{"_type":"ref","varName":"GameHeader"}}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"getValue"},"arg":{"_type":"lit","value":"GlobalVars"}}},"arg":{"_type":"lambda","varName":"GlobalVars","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"merge"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nlight refill: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nredraw: "}},"arg":{"_type":"ref","varName":"nil"}}}},"arg":{"_type":"ref","varName":"GlobalVars"}}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"getValue"},"arg":{"_type":"lit","value":"Actions"}}},"arg":{"_type":"lambda","varName":"Actions","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nNum Actions: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"length"},"arg":{"_type":"ref","varName":"Actions"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nFirst Action: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"at"},"arg":{"_type":"ref","varName":"Actions"}},"arg":{"_type":"lit","value":0}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nLast Action: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"last"},"arg":{"_type":"ref","varName":"Actions"}}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"getValue"},"arg":{"_type":"lit","value":"Nouns"}}},"arg":{"_type":"lambda","varName":"Nouns","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nNum Nouns: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"length"},"arg":{"_type":"ref","varName":"Nouns"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":" Nouns: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"Nouns"}},"arg":{"_type":"ref","varName":"nil"}}}}}}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"getValue"},"arg":{"_type":"lit","value":"Verbs"}}},"arg":{"_type":"lambda","varName":"Verbs","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nNum Verbs: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"length"},"arg":{"_type":"ref","varName":"Verbs"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":" Verbs: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"Verbs"}},"arg":{"_type":"ref","varName":"nil"}}}}}}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"ref","varName":"debugGame2"}}}}}}}}}}}}}}}}}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"debugGame2"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"debugGame2 = do    \n  Rooms <- getValue 'Rooms'\n  print concat[ \"\\nNum Rooms: \" (length Rooms) '\\nFirst Room: ' (at Rooms 0) '\\nLast Room: ' (last Rooms)]\n  print concat[ \"\\nAll Rooms: \" Rooms ]\n  Messages <- getValue 'Messages'\n  print concat[ \"\\nNum Messsages: \" (length Messages) \" All Messages: \" Messages ]\n  Items <- getValue 'Items'\n  print concat[ \"\\nNum Items: \" (length Items) \" All Items: \" Items ]\n  GameFooter <- getValue 'GameFooter'\n  print (merge [ '\\nversion: ' '\\nnadv number: ' '\\nunknown: '] GameFooter)\n  \"Debug finished.\""}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"getValue"},"arg":{"_type":"lit","value":"Rooms"}}},"arg":{"_type":"lambda","varName":"Rooms","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nNum Rooms: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"length"},"arg":{"_type":"ref","varName":"Rooms"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nFirst Room: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"at"},"arg":{"_type":"ref","varName":"Rooms"}},"arg":{"_type":"lit","value":0}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nLast Room: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"last"},"arg":{"_type":"ref","varName":"Rooms"}}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nAll Rooms: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"Rooms"}},"arg":{"_type":"ref","varName":"nil"}}}}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"getValue"},"arg":{"_type":"lit","value":"Messages"}}},"arg":{"_type":"lambda","varName":"Messages","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nNum Messsages: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"length"},"arg":{"_type":"ref","varName":"Messages"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":" All Messages: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"Messages"}},"arg":{"_type":"ref","varName":"nil"}}}}}}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"getValue"},"arg":{"_type":"lit","value":"Items"}}},"arg":{"_type":"lambda","varName":"Items","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nNum Items: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"length"},"arg":{"_type":"ref","varName":"Items"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":" All Items: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"Items"}},"arg":{"_type":"ref","varName":"nil"}}}}}}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"getValue"},"arg":{"_type":"lit","value":"GameFooter"}}},"arg":{"_type":"lambda","varName":"GameFooter","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"merge"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nversion: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nnadv number: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nunknown: "}},"arg":{"_type":"ref","varName":"nil"}}}}},"arg":{"_type":"ref","varName":"GameFooter"}}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"lit","value":"Debug finished."}}}}}}}}}}}}}}}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"playGame"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"playGame = do\n  look 0\n  performActions 0 0\n  print concat[ \"\\nTell me what to do ? \" ]\n  input = getInput\n  result = performActions (at input 0) (at input 1)\n  eq result -1\n    print concat[ \"I don't understand your command.\\n\" ]\n    eq result -2\n      print concat[ \"You can't do that yet.\\n\" ]\n      nil\n  processLight\n  #playGame"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"look"},"arg":{"_type":"lit","value":0}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"performActions"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":0}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"\nTell me what to do ? "}},"arg":{"_type":"ref","varName":"nil"}}}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"let","varName":"input","value":{"_type":"ref","varName":"getInput"},"body":{"_type":"let","varName":"result","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"performActions"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"at"},"arg":{"_type":"ref","varName":"input"}},"arg":{"_type":"lit","value":0}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"at"},"arg":{"_type":"ref","varName":"input"}},"arg":{"_type":"lit","value":1}}},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"eq"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"-"},"arg":{"_type":"ref","varName":"result"}},"arg":{"_type":"lit","value":1}}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"I don't understand your command.\n"}},"arg":{"_type":"ref","varName":"nil"}}}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"eq"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"-"},"arg":{"_type":"ref","varName":"result"}},"arg":{"_type":"lit","value":2}}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"You can't do that yet.\n"}},"arg":{"_type":"ref","varName":"nil"}}}}},"arg":{"_type":"ref","varName":"nil"}}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"ref","varName":"processLight"}}}}}}}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"processLight"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"processLight = do\n  timeleft <- peek 'GameHeader' GH_LIGHT_TIME\n  light <- peek 'Items' LIGHT_SOURCE\n  where = at light 1\n  or (eq where DESTROYED) (eq timeleft -1) # -1 means lasts forever, nothing to do\n    nil         \n    lightTick\n  nil\n  "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"peek"},"arg":{"_type":"lit","value":"GameHeader"}},"arg":{"_type":"ref","varName":"GH_LIGHT_TIME"}}},"arg":{"_type":"lambda","varName":"timeleft","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"peek"},"arg":{"_type":"lit","value":"Items"}},"arg":{"_type":"ref","varName":"LIGHT_SOURCE"}}},"arg":{"_type":"lambda","varName":"light","body":{"_type":"let","varName":"where","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"at"},"arg":{"_type":"ref","varName":"light"}},"arg":{"_type":"lit","value":1}},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"or"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"eq"},"arg":{"_type":"ref","varName":"where"}},"arg":{"_type":"ref","varName":"DESTROYED"}}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"eq"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"-"},"arg":{"_type":"ref","varName":"timeleft"}},"arg":{"_type":"lit","value":1}}}},"arg":{"_type":"ref","varName":"nil"}},"arg":{"_type":"ref","varName":"lightTick"}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"ref","varName":"nil"}}}}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"lightTick"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"lightTick = do\n  timeleft <- (peek 'GameHeader' GH_LIGHT_TIME) - 1\n  myloc <- peek 'GameHeader' GH_PLAYER_ROOM\n  >= timeleft 0  # save it back if not negative\n    poke 'GameHeader' GH_LIGHT_TIME timeleft\n    nil\n  eq timeleft 0\n    do\n      poke 'BitFlags' LIGHTOUTBIT 1\n      isLightPresent myloc\n        print \"Your light has run out.\\n\"\n        nil\n    and (< timeleft 25) (isLightPresent myloc)\n      print concat[ \"You light runs out in \" timeleft \" turns.\\n\"]\n      nil\n      "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"-"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"peek"},"arg":{"_type":"lit","value":"GameHeader"}},"arg":{"_type":"ref","varName":"GH_LIGHT_TIME"}}},"arg":{"_type":"lit","value":1}}},"arg":{"_type":"lambda","varName":"timeleft","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"peek"},"arg":{"_type":"lit","value":"GameHeader"}},"arg":{"_type":"ref","varName":"GH_PLAYER_ROOM"}}},"arg":{"_type":"lambda","varName":"myloc","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":">="},"arg":{"_type":"ref","varName":"timeleft"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"poke"},"arg":{"_type":"lit","value":"GameHeader"}},"arg":{"_type":"ref","varName":"GH_LIGHT_TIME"}},"arg":{"_type":"ref","varName":"timeleft"}}},"arg":{"_type":"ref","varName":"nil"}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"eq"},"arg":{"_type":"ref","varName":"timeleft"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"poke"},"arg":{"_type":"lit","value":"BitFlags"}},"arg":{"_type":"ref","varName":"LIGHTOUTBIT"}},"arg":{"_type":"lit","value":1}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"isLightPresent"},"arg":{"_type":"ref","varName":"myloc"}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"lit","value":"Your light has run out.\n"}}},"arg":{"_type":"ref","varName":"nil"}}}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"and"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"<"},"arg":{"_type":"ref","varName":"timeleft"}},"arg":{"_type":"lit","value":25}}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"isLightPresent"},"arg":{"_type":"ref","varName":"myloc"}}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"You light runs out in "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"timeleft"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":" turns.\n"}},"arg":{"_type":"ref","varName":"nil"}}}}}}},"arg":{"_type":"ref","varName":"nil"}}}}}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"look"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"look ignore = do\n  myloc <- peek 'GameHeader' GH_PLAYER_ROOM\n  darkbit <- peek 'BitFlags' DARKBIT\n  and (eq darkbit 1) (not (isLightPresent myloc))\n    print \"You can't see. It is too dark!\\n\"\n    basicLook myloc"}},"arg":{"_type":"lambda","varName":"ignore","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"peek"},"arg":{"_type":"lit","value":"GameHeader"}},"arg":{"_type":"ref","varName":"GH_PLAYER_ROOM"}}},"arg":{"_type":"lambda","varName":"myloc","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"peek"},"arg":{"_type":"lit","value":"BitFlags"}},"arg":{"_type":"ref","varName":"DARKBIT"}}},"arg":{"_type":"lambda","varName":"darkbit","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"and"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"eq"},"arg":{"_type":"ref","varName":"darkbit"}},"arg":{"_type":"lit","value":1}}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"not"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"isLightPresent"},"arg":{"_type":"ref","varName":"myloc"}}}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"lit","value":"You can't see. It is too dark!\n"}}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"basicLook"},"arg":{"_type":"ref","varName":"myloc"}}}}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"basicLook"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"basicLook myloc = do\n  room <- peek 'Rooms' myloc\n  name = strReplace (at room 6) (regexp '\\\\{nl\\\\}') '\\n'  # swap out any {nl} for real newlines\n  strMatches name '^\\\\*'\n    print name\n    print concat[ \"You are in a \" name ]\n  printExits room\n  printItems myloc\n  print \"\\n\""}},"arg":{"_type":"lambda","varName":"myloc","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"peek"},"arg":{"_type":"lit","value":"Rooms"}},"arg":{"_type":"ref","varName":"myloc"}}},"arg":{"_type":"lambda","varName":"room","body":{"_type":"let","varName":"name","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"strReplace"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"at"},"arg":{"_type":"ref","varName":"room"}},"arg":{"_type":"lit","value":6}}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"regexp"},"arg":{"_type":"lit","value":"\\{nl\\}"}}},"arg":{"_type":"lit","value":"\n"}},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"strMatches"},"arg":{"_type":"ref","varName":"name"}},"arg":{"_type":"lit","value":"^\\*"}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"ref","varName":"name"}}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"You are in a "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"ref","varName":"name"}},"arg":{"_type":"ref","varName":"nil"}}}}}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"printExits"},"arg":{"_type":"ref","varName":"room"}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"printItems"},"arg":{"_type":"ref","varName":"myloc"}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"lit","value":"\n"}}}}}}}}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"isNumber"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"isNumber i = == (getType i) '*number'"}},"arg":{"_type":"lambda","varName":"i","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"=="},"arg":{"_type":"apply","func":{"_type":"ref","varName":"getType"},"arg":{"_type":"ref","varName":"i"}}},"arg":{"_type":"lit","value":"*number"}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"safeat"}},"arg":{"_type":"lit","value":2}},"arg":{"_type":"lit","value":"safeat list idx = isCons list\n  isNumber idx\n    > (length list) idx\n      at list idx\n      'OOB LIST'\n    'IDX NOT NUM'  \n  'LIST NOT LIST'"}},"arg":{"_type":"lambda","varName":"list","body":{"_type":"lambda","varName":"idx","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"isCons"},"arg":{"_type":"ref","varName":"list"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"isNumber"},"arg":{"_type":"ref","varName":"idx"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":">"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"length"},"arg":{"_type":"ref","varName":"list"}}},"arg":{"_type":"ref","varName":"idx"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"at"},"arg":{"_type":"ref","varName":"list"}},"arg":{"_type":"ref","varName":"idx"}}},"arg":{"_type":"lit","value":"OOB LIST"}}},"arg":{"_type":"lit","value":"IDX NOT NUM"}}},"arg":{"_type":"lit","value":"LIST NOT LIST"}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"mapIndex"}},"arg":{"_type":"lit","value":2}},"arg":{"_type":"lit","value":"mapIndex func l = _mapIndex 0 func l"}},"arg":{"_type":"lambda","varName":"func","body":{"_type":"lambda","varName":"l","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"_mapIndex"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"ref","varName":"func"}},"arg":{"_type":"ref","varName":"l"}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"_mapIndex"}},"arg":{"_type":"lit","value":3}},"arg":{"_type":"lit","value":"_mapIndex idx func l = l (\\h t D . cons (func h idx) (_mapIndex (+ 1 idx) func t)) nil"}},"arg":{"_type":"lambda","varName":"idx","body":{"_type":"lambda","varName":"func","body":{"_type":"lambda","varName":"l","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"l"},"arg":{"_type":"lambda","varName":"h","body":{"_type":"lambda","varName":"t","body":{"_type":"lambda","varName":"D","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"func"},"arg":{"_type":"ref","varName":"h"}},"arg":{"_type":"ref","varName":"idx"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"_mapIndex"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"+"},"arg":{"_type":"lit","value":1}},"arg":{"_type":"ref","varName":"idx"}}},"arg":{"_type":"ref","varName":"func"}},"arg":{"_type":"ref","varName":"t"}}}}}}},"arg":{"_type":"ref","varName":"nil"}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"hasExit"}},"arg":{"_type":"lit","value":2}},"arg":{"_type":"lit","value":"hasExit exit idx = eq exit 0\n  ''\n  safeat Exits idx"}},"arg":{"_type":"lambda","varName":"exit","body":{"_type":"lambda","varName":"idx","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"eq"},"arg":{"_type":"ref","varName":"exit"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":""}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"safeat"},"arg":{"_type":"ref","varName":"Exits"}},"arg":{"_type":"ref","varName":"idx"}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"printExits"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"printExits room = do\n  exits = removeIf (eq '') (mapIndex (hasExit) (removeLast room))\n  isNil exits\n    print \"Obvious exits: none.\"\n    print concat[ \"Obvious exits: \"  | (intersperse exits \", \") ]"}},"arg":{"_type":"lambda","varName":"room","body":{"_type":"let","varName":"exits","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"removeIf"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"eq"},"arg":{"_type":"lit","value":""}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"mapIndex"},"arg":{"_type":"ref","varName":"hasExit"}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"removeLast"},"arg":{"_type":"ref","varName":"room"}}}},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"isNil"},"arg":{"_type":"ref","varName":"exits"}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"lit","value":"Obvious exits: none."}}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"Obvious exits: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"intersperse"},"arg":{"_type":"ref","varName":"exits"}},"arg":{"_type":"lit","value":", "}}}}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"printItems"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"printItems myloc = do\n  allitems <- getValue 'Items'\n  items <- findItemsInLocation myloc allitems\n  isNil items\n    items\n    print concat[ \"You can also see: \" | (intersperse (map (\\x . (at x 0)) items) ',') ]  #have to extract the name from each item"}},"arg":{"_type":"lambda","varName":"myloc","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"getValue"},"arg":{"_type":"lit","value":"Items"}}},"arg":{"_type":"lambda","varName":"allitems","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"findItemsInLocation"},"arg":{"_type":"ref","varName":"myloc"}},"arg":{"_type":"ref","varName":"allitems"}}},"arg":{"_type":"lambda","varName":"items","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"isNil"},"arg":{"_type":"ref","varName":"items"}},"arg":{"_type":"ref","varName":"items"}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"strCat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"You can also see: "}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"intersperse"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"map"},"arg":{"_type":"lambda","varName":"x","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"at"},"arg":{"_type":"ref","varName":"x"}},"arg":{"_type":"lit","value":0}}}},"arg":{"_type":"ref","varName":"items"}}},"arg":{"_type":"lit","value":","}}}}}}}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"findItemsInLocation"}},"arg":{"_type":"lit","value":2}},"arg":{"_type":"lit","value":"findItemsInLocation myloc items = isNil items\n  items\n  eq (safeat (head items) 1) myloc\n    cons (head items) findItemsInLocation myloc (tail items)\n    do\n      print myloc\n      print (head items)\n      print (safeat (head (tail items)) 1)\n      findItemsInLocation myloc (tail items)"}},"arg":{"_type":"lambda","varName":"myloc","body":{"_type":"lambda","varName":"items","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"isNil"},"arg":{"_type":"ref","varName":"items"}},"arg":{"_type":"ref","varName":"items"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"eq"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"safeat"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"head"},"arg":{"_type":"ref","varName":"items"}}},"arg":{"_type":"lit","value":1}}},"arg":{"_type":"ref","varName":"myloc"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"head"},"arg":{"_type":"ref","varName":"items"}}},"arg":{"_type":"ref","varName":"findItemsInLocation"}},"arg":{"_type":"ref","varName":"myloc"}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"tail"},"arg":{"_type":"ref","varName":"items"}}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"ref","varName":"myloc"}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"head"},"arg":{"_type":"ref","varName":"items"}}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"print"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"safeat"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"head"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"tail"},"arg":{"_type":"ref","varName":"items"}}}},"arg":{"_type":"lit","value":1}}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"findItemsInLocation"},"arg":{"_type":"ref","varName":"myloc"}},"arg":{"_type":"apply","func":{"_type":"ref","varName":"tail"},"arg":{"_type":"ref","varName":"items"}}}}}}}}}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"tp"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"tp room = do\n  poke 'GameHeader' GH_PLAYER_ROOM room\n  look 0\n  "}},"arg":{"_type":"lambda","varName":"room","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"poke"},"arg":{"_type":"lit","value":"GameHeader"}},"arg":{"_type":"ref","varName":"GH_PLAYER_ROOM"}},"arg":{"_type":"ref","varName":"room"}}},"arg":{"_type":"lambda","varName":"_","body":{"_type":"apply","func":{"_type":"ref","varName":"look"},"arg":{"_type":"lit","value":0}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"isLightPresent"}},"arg":{"_type":"lit","value":1}},"arg":{"_type":"lit","value":"isLightPresent myloc = do\n  light <- peek 'Items' LIGHT_SOURCE\n  where = at light 1\n  or (eq where myloc) (eq where CARRIED)"}},"arg":{"_type":"lambda","varName":"myloc","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"peek"},"arg":{"_type":"lit","value":"Items"}},"arg":{"_type":"ref","varName":"LIGHT_SOURCE"}}},"arg":{"_type":"lambda","varName":"light","body":{"_type":"let","varName":"where","value":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"at"},"arg":{"_type":"ref","varName":"light"}},"arg":{"_type":"lit","value":1}},"body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"or"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"eq"},"arg":{"_type":"ref","varName":"where"}},"arg":{"_type":"ref","varName":"myloc"}}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"eq"},"arg":{"_type":"ref","varName":"where"}},"arg":{"_type":"ref","varName":"CARRIED"}}}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"getInput"}},"arg":{"_type":"lit","value":0}},"arg":{"_type":"lit","value":"getInput = do\n  move <- prompt (concat [\"Tell me what to do?\" ])\n  [ 0 0 ]"}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"bind"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"prompt"},"arg":{"_type":"apply","func":{"_type":"ref","varName":"concat"},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":"Tell me what to do?"}},"arg":{"_type":"ref","varName":"nil"}}}}},"arg":{"_type":"lambda","varName":"move","body":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"cons"},"arg":{"_type":"lit","value":0}},"arg":{"_type":"ref","varName":"nil"}}}}}},
  {"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"apply","func":{"_type":"ref","varName":"define"},"arg":{"_type":"lit","value":"performActions"}},"arg":{"_type":"lit","value":2}},"arg":{"_type":"lit","value":"performActions verb noun = do\n  -1"}},"arg":{"_type":"lambda","varName":"verb","body":{"_type":"lambda","varName":"noun","body":{"_type":"apply","func":{"_type":"ref","varName":"-"},"arg":{"_type":"lit","value":1}}}}}
]