
###########
# hashmaps!
###########

add-hash k v hashmap = cons (cons k v) (remove-hash k hashmap)

key cons = head cons
value cons = tail cons

get-pair k hashmap = find-if (\x . eq (head x) k) hashmap
get-value k hashmap = (\pair. if (eq pair nil) nil (value pair)) (get-pair k hashmap)
get-value-default k default hashmap = do
  val = get-value k hashmap
  if (neq val nil) val default

#foo = add-hash a 3 nil


remove-hash k hashmap = remove-if (\x . eq (head x) k) hashmap
